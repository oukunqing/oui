<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>冻结窗格插件示例</title>
<style type="text/css">
.tb{border-collapse:collapse;}
.tb td{border:solid 1px #d0d7e5; text-indent:5px; height:24px; padding:0;}
.tb thead{background:#dfe8f6;}
.tb thead td{ vertical-align:middle; text-align:center; font-weight:bold; font-size:18px;}

.tb tbody{}
.tb tbody td{text-align:center;font-size:14px;}

select {margin-right:10px;}
</style>
    <script type="text/javascript" src="../oui/oui.js?12"></script>
    <script type="text/javascript" src="../oui/frozen/oui.frozen.js?123"></script>
</head>

<body>
<div style="padding:0 0 10px 0;">
<div style="line-height:24px;margin-bottom:10px;"><span style="color:#f00;">请注意：不兼容IE9以下版本的IE浏览器</span>
<br />说明：当启用强制固定表头时，且表格包含tHead时，则强制固定表头。<br />当表格宽度高度小于DIV容器的宽度高度（没出现滚动条）时，则不启用冻结</div>
<label><input type="checkbox" id="chbHead" /><span>强制固定表头</span></label>
<label><input type="checkbox" id="chbLine" checked="checked" /><span>显示分割线</span></label>
&nbsp;&nbsp;&nbsp;&nbsp;
上:
<select id="ddlHead"></select>
左:
<select id="ddlLeft"></select>
下:
<select id="ddlFoot"></select>
右:
<select id="ddlRight"></select>
<input type="button" value="冻结" onclick="frozen();" />
<input type="button" value="隐藏" onclick="hide();" />
<input type="button" value="显示" onclick="show();" />
</div>
<div id="divBox" style="width:700px; height:300px; overflow:auto;border:solid 1px #f00;padding:0px;margin:0; position: relative;">
<table cellpadding="0" cellspacing="0" border="0" class="tb"  style="width:1000px;">
	<thead>
	<tr>
		<td>11</td>
		<td>12</td>
		<td>13</td>
		<td onclick="alert('这是原来的点击事件');">14</td>
		<td rowspan="1">15</td>
		<td>16</td>
		<td>17</td>
		<td>18</td>
	</tr>
	<tr>
		<td >21</td>
		<td>22</td>
		<td>23</td>
		<td>24</td>
		<td>25</td>
		<td>26</td>
		<td>27</td>
		<td>28</td>
	</tr>
	</thead>
	<tbody>
	<tr>
		<td colspan="2">31</td>
		<td>33</td>
		<td>34</td>
		<td>35</td>
		<td>36</td>
		<td>37</td>
		<td>38</td>
	</tr>
	<tr>
		<td>41</td>
		<td>42</td>
		<td>43</td>
		<td>44</td>
		<td>45</td>
		<td>46</td>
		<td>47</td>
		<td>48</td>
	</tr>
	<tr>
		<td>51</td>
		<td>52</td>
		<td>53</td>
		<td>54</td>
		<td>55</td>
		<td>56</td>
		<td>57</td>
		<td>58</td>
	</tr>
	<tr>
		<td rowspan="2">61</td>
		<td>62</td>
		<td>63</td>
		<td>64</td>
		<td>65</td>
		<td>66</td>
		<td>67</td>
		<td>68</td>
	</tr>
	<tr>
		<td>72</td>
		<td>73</td>
		<td>74</td>
		<td>75</td>
		<td>76</td>
		<td>77</td>
		<td>78</td>
	</tr>
	<tr>
		<td rowspan="2">81</td>
		<td>82</td>
		<td>83</td>
		<td>84</td>
		<td>85</td>
		<td>86</td>
		<td>87</td>
		<td>88</td>
	</tr>
	<tr>
		<td>92</td>
		<td>93</td>
		<td>94</td>
		<td>95</td>
		<td>96</td>
		<td>97</td>
		<td>98</td>
	</tr>
	<tr>
		<td rowspan="2">101</td>
		<td>102</td>
		<td>103</td>
		<td>104</td>
		<td>105</td>
		<td>106</td>
		<td>107</td>
		<td>108</td>
	</tr>
	<tr>
		<td>112</td>
		<td>113</td>
		<td>114</td>
		<td>115</td>
		<td>116</td>
		<td>117</td>
		<td>118</td>
	</tr>
	<tr>
		<td rowspan="2">121</td>
		<td>122</td>
		<td>123</td>
		<td>124</td>
		<td>125</td>
		<td>126</td>
		<td>127</td>
		<td>128</td>
	</tr>
	<tr>
		<td>132</td>
		<td>133</td>
		<td>134</td>
		<td>135</td>
		<td>136</td>
		<td>137</td>
		<td>138</td>
	</tr>
	<tr>
		<td rowspan="2">141</td>
		<td>142</td>
		<td>143</td>
		<td>144</td>
		<td>145</td>
		<td>146</td>
		<td>147</td>
		<td>148</td>
	</tr>
	<tr>
		<td>152</td>
		<td>153</td>
		<td>154</td>
		<td>155</td>
		<td>156</td>
		<td>157</td>
		<td>158</td>
	</tr>
	<tr>
		<td>161</td>
		<td>162</td>
		<td>163</td>
		<td>164</td>
		<td>165</td>
		<td>166</td>
		<td>167</td>
		<td>168</td>
	</tr>
	<tr>
		<td>171</td>
		<td>172</td>
		<td>173</td>
		<td>174</td>
		<td>175</td>
		<td>176</td>
		<td>177</td>
		<td>178</td>
	</tr>
	<tr>
		<td>181</td>
		<td>182</td>
		<td>183</td>
		<td>184</td>
		<td>185</td>
		<td>186</td>
		<td>187</td>
		<td>188</td>
	</tr>
	<tr>
		<td>191</td>
		<td>192</td>
		<td>193</td>
		<td>194</td>
		<td>195</td>
		<td>196</td>
		<td>197</td>
		<td>198</td>
	</tr>
	<tr>
		<td>201</td>
		<td>202</td>
		<td>203</td>
		<td>204</td>
		<td>205</td>
		<td>206</td>
		<td>207</td>
		<td>208</td>
	</tr>
	</tbody>
</table>
</div>
</body>
</html>
<script type="text/javascript">
window.onload = function() {
	var head = $I('ddlHead'),
		left = $I('ddlLeft'),
		foot = $I('ddlFoot'),
		right = $I('ddlRight');
	
	for(var i = 0; i <= 10; i++) {
		head.options.add(new Option(i, i));
		left.options.add(new Option(i, i));
		foot.options.add(new Option(i, i));
		right.options.add(new Option(i, i));
	}
	
	head.selectedIndex = 2;
	left.selectedIndex = 2;
	foot.selectedIndex = 1;
	right.selectedIndex = 1;
};

window.onresize = function() {
	var bs = $.getBodySize();
	if(bs.width < 800) {
		return false;
	}
	var box = $I('divBox');
	box.style.width = bs.width * 0.9 + 'px';
	box.style.height = bs.height * 0.6 + 'px';
};

var ii = 0;

var table = $I('divBox').childNodes[1], fid = '';

function frozen() {
	var fixHead = $I('chbHead').checked, 
		head = parseInt('0' + $I('ddlHead').value, 10),
		left = parseInt('0' + $I('ddlLeft').value, 10),
		foot = parseInt('0' + $I('ddlFoot').value, 10),
		right = parseInt('0' + $I('ddlRight').value, 10);

	//是否强制冻结（表格已经冻结后，可以直接重新冻结）
	//如果表格table一直存在，而只是行tr改变，就需要设置为 true,
	//如果表格table每次也是重新创建（或重新.innerHTML | .html(...) ) 可以设置为 false
	//因为有防止重复冻结功能，调用.frozen后，表格table会被设置forzen-id属性以示标记
	var force = true;

	var showLine = $I('chbLine').checked;

	//console.log('table:', table);
	//var table = 'tb1';
	var fo = $.frozen(table, {
		//上部行数
		rows: head,			//rows, head
		//固定tHead
		fixHead: fixHead,
		//左边列数
		cols: left,			//cols, left
		//底部行数
		foot: foot,
		//右边列数
		right: right,
		//是否显示分割线
		showBorder: showLine,  // showSplitLine, showLine
		////线条颜色可以自定义，默认为 #646464（即excel中的窗口冻结分割线颜色）
		//lineColor: '#ccc',

		//分割线样式，border 参数优先于 lineColor
		border: '',         //'solid 2px #f00'
		//setBackground: true,	// showBackground
		////冻结部分的单元格背景色，可以自定义，默认按原来的单元格背景色不变
		//background: '#f1f1f1',
		//debounce: false,
		//冻结完成后回调函数
		complete: function(f) {
			console.log('f:', ii++, f);
			fid = f.id;
		}
	}, force);

/*
	fo.hide();

	fo.show();

	fo.resize();
*/
}

function show() {
	$.frozen.show(fid);
}

function hide() {
	$.frozen.hide(fid);
}

function resize() {
	$.frozen.resize(fid);
}

</script>