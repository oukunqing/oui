<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>树形菜单</title>
    <style type="text/css">
        body {background:#fff;margin:0;padding:0;font-size: 14px;font-family: 宋体;}
        .form{background: #fff;overflow: hidden;}
        div{clear:both;overflow:hidden;}
        div.box {border:solid 1px #ccc;border-radius:4px;padding:8px 8px 0;margin:0 0 6px 0;}
        button{ height:30px;line-height:24px; padding:0 6px;font-family: 宋体;font-size:14px;
            display:inline-block;float:left;margin:0 6px 6px 0;cursor: pointer;}
        select {height:30px;border:solid 1px #ccc;border-radius: 4px;float:left;margin:0 6px 6px 0;font-size: 14px;}
        .txt {height:26px;line-height:26px;border:solid 1px #ccc;text-align:center;font-size:14px;border-radius:4px;}
        .item { padding:0 0 6px 0;}
        .item span,.item button,.item input {float:left;margin:0 6px 6px 0;}
        .item span{line-height:28px;}
        .chb-label {border:solid 1px #ccc;border-radius:4px;box-sizing:border-box;padding:5px 6px 0 2px;height:30px;
            display:inline-block;overflow:hidden;float:left;margin:0 6px 6px 0;}
        .chb-label input{float:left;margin:3px 5px 0 2px;}
        .chb-label span{line-height:18px;margin:0;}
    </style>
</head>
<body>
<div class="form">
    <div style="float:left;padding:6px;clear:none;">
        <div id="tree" style="display:block;border:solid 1px #ccc;border-radius:4px;overflow:hidden;width:500px;height:600px;margin:0 0 5px 0;"></div>    
        <select id="unit" style="width:100%;max-width:500px;height:34px;" onchange="$.console.log('changed:', this.value);">
            <option value="7155,8366">205428,866804050921863</option>
        </select>
        <div id="tree1" style="display:block;border:solid 1px #ccc;border-radius:4px;overflow:auto;width:500px;height:200px;margin:0;"></div>
        <div style="margin-bottom:800px;"></div>
    </div>
    <div style="float:left;padding:0;margin:6px 0 0;clear:none;">
        <div class="box">
            <div>
                <label class="chb-label"><input type="checkbox" value="root" name="chbData" checked="checked" /><span>根节点</span></label>
                <label class="chb-label"><input type="checkbox" value="unit" name="chbData" checked="checked" /><span>目录</span></label>
                <label class="chb-label"><input type="checkbox" value="device" name="chbData" /><span>设备</span></label>
                <label class="chb-label"><input type="checkbox" value="camera" name="chbData" /><span>通道</span></label>
                <label class="chb-label"><input type="checkbox" value="department" name="chbData" /><span>部门</span></label>
                <label class="chb-label"><input type="checkbox" value="person" name="chbData" /><span>人员</span></label>
                <select id="ddlTreeId">
                    <option value="tree">目录树</option>
                    <option value="unit">下拉列表</option>
                </select>
            </div>
            <div class="item">
                <select id="ddlLevel">
                    <option value="-1">全部展开</option>
                    <option value="0">全部收缩</option>
                    <option value="1">展开到1级</option>
                    <option value="2">展开到2级</option>
                    <option value="3">展开到3级</option>
                    <option value="4">展开到4级</option>
                    <option value="5">展开到5级</option>
                    <option value="6">展开到6级</option>
                </select>
                <span>Skin</span>
                <select id="ddlSkin" style="font-size:14px;">
                    <option value="default" selected="selected">Default</option>
                    <option value="device">Device</option>
                </select>
                <span>Switch</span>
                <select id="ddlSwitch" style="font-size:14px;">
                    <option value="">Empty</option>
                    <option value="default">Default</option>
                    <option value="radius">Radius</option>
                    <option value="device">Device</option>
                    <option value="arrow">Arrow</option>
                    <option value="updown">UpDown</option>
                </select>
                <label class="chb-label"><input type="checkbox" id="chbDynamic" /><span>动态加载节点</span></label>
                <label class="chb-label"><input type="checkbox" id="chbCamera" /><span>动态加载通道</span></label>
                <div></div>
                <label class="chb-label"><input type="checkbox" id="chbLine" /><span>显示连线</span></label>
                <label class="chb-label" title="鼠标悬停显示连线"><input type="checkbox" id="chbHoverLine" /><span>悬停显示</span></label>
                <label class="chb-label"><input type="checkbox" id="chbIcon" checked="checked" /><span>显示图标</span></label>
                <label class="chb-label"><input type="checkbox" id="chbCheck" checked="checked" /><span>显示选框</span></label>
                <label class="chb-label"><input type="checkbox" id="chbType" checked="checked" /><span>显示类型</span></label>
                <label class="chb-label"><input type="checkbox" id="chbStatus" checked="checked" /><span>显示状态</span></label>
                <label class="chb-label"><input type="checkbox" id="chbCount" checked="checked" /><span>显示数量</span></label>
                <div></div>
                <label class="chb-label"><input type="checkbox" id="chbTitle" checked="checked" /><span>显示标题</span></label>
                <label class="chb-label"><input type="checkbox" id="chbButton" /><span>显示按钮</span></label>
                <label class="chb-label"><input type="checkbox" id="chbMoveAble" /><span>允许移动</span></label>
                <label class="chb-label"><input type="checkbox" id="chbMove" /><span>显示移动</span></label>
                <label class="chb-label"><input type="checkbox" id="chbDragAble" /><span>允许拖动</span></label>
                <label class="chb-label"><input type="checkbox" id="chbDragMove" /><span>拖动迁移</span></label>
                <label class="chb-label"><input type="checkbox" id="chbDragSize" /><span>拖动改变高度</span></label>
                <div></div>
                <label class="chb-label"><input type="checkbox" id="chbSearch" checked="checked" /><span>显示搜索</span></label>
                <label class="chb-label"><input type="checkbox" id="chbRealSearch" /><span>实时搜索</span></label>
                <label class="chb-label"><input type="checkbox" id="chbClearSearch" /><span>清除搜索</span></label>
                <label class="chb-label"><input type="checkbox" id="chbBottom" /><span>显示底部</span></label>
                <select id="ddlBottomAlign" style="font-size:14px;">
                    <option value="left">左对齐</option>
                    <option value="center" selected="selected">居中</option>
                    <option value="right">右对齐</option>
                </select>
                <label class="chb-label"><input type="checkbox" id="chbDesc" checked="checked" /><span>显示备注</span></label>
                <label class="chb-label"><input type="checkbox" id="chbInfo" /><span>显示信息</span></label>
                <div></div>
                <label class="chb-label"><input type="checkbox" id="chbKeepStatus" /><span>保持状态</span></label>
                <label class="chb-label"><input type="checkbox" id="chbKeepCookie" /><span>保存COOKIE</span></label>
                <label class="chb-label"><input type="checkbox" id="chbClickExpand" /><span>点击切换</span></label>
                <label class="chb-label"><input type="checkbox" id="chbClickChecked" /><span>点击选中</span></label>
                <label class="chb-label"><input type="checkbox" id="chbCallbackLevel" /><span>确认再返回</span></label>
                <label class="chb-label" title="启用自定义样式可以实现节点样式自由，可增加行高或全宽，或改变背景及字体颜色等等&#10;需要注意的是：自定义的样式符合节点结构设计，否则可能会引起节点布局混乱">
                    <input type="checkbox" id="chbCustomCss" />
                    <span style="color:#f00;">自定义样式</span>
                </label>
                <div></div>
                <label class="chb-label" title="显示连线时不可用"><input type="checkbox" id="chbFullWidth" /><span>整行全宽</span></label>
                <label class="chb-label" title="显示连线时不可用"><input type="checkbox" id="chbHighHeight" /><span>增加行高</span></label>
                <label class="chb-label" title="同一层级下仅展开一个节点"><input type="checkbox" id="chbOnlyOpenOne" /><span>仅展开一个节点</span></label>
                <label class="chb-label"><input type="checkbox" id="chbTreeMenu" /><span>树形导航菜单</span></label>
                <label class="chb-label"><input type="checkbox" id="chbRightSwitch" /><span>右侧切换图标</span></label>

                <div>
                    <button onclick="test(0);">加载树菜单</button>
                    <button onclick="test(1);">加载树菜单1</button>
                    <button onclick="test(2);">实时加载树菜单</button>
                    <button onclick="test(3);">加载树菜单(测试)</button>
                </div>
            </div>
        </div>
        <div id="divOper" class="box" style="display:none;">
            <div>
                <label class="chb-label">
                    <input type="checkbox" value="1" id="chbLinkage" checked="checked" />
                    <span>级联</span>
                </label>
                <label class="chb-label">
                    <input type="checkbox" value="1" id="chbReverse" checked="checked" />
                    <span>反转（层级）</span>
                </label>
            </div>
            <div>
                <select id="ddlLevel2" style="width:62px;">
                    <option value="0">0级</option>
                    <option value="1">1级</option>
                    <option value="2">2级</option>
                    <option value="3">3级</option>
                    <option value="4">4级</option>
                    <option value="5">5级</option>
                    <option value="6">6级</option>
                    <option value="7">7级</option>
                </select>
                <button onclick="expandLevel();">按层级展开</button>
                <button onclick="expandLevel(false);">按层级收缩</button>
                <button onclick="expandAll();">全部展开</button>
                <button onclick="expandAll(false);">全部收缩</button>
            </div>
            <div>
                <select id="ddlType2" style="width:62px;">
                    <option value="unit">目录</option>
                    <option value="device">设备</option>
                    <option value="camera">通道</option>
                    <option value="department">部门</option>
                    <option value="person">人员</option>
                </select>
                <button onclick="expandType();">按类型展开</button>
                <button onclick="expandType(false);">按类型收缩</button>
            </div>
            <div style="border-top:solid 1px #ccc;border-bottom:solid 1px #ccc;padding:8px 0 0;margin:2px 0 7px; display: block;overflow: hidden;">
                <div style="padding:0 0 5px 0;" class="item">
                    <span>原节点:</span>
                    <input type="text" id="txtNodeId" class="txt" style="width:180px;" placeholder="是NodeId 不是DataId" />
                    
                    <button onclick="expand();">展开</button>
                    <button onclick="collapse();">收缩</button>
                    <button onclick="expand(true);">展开至</button>
                    <button onclick="collapse(true);">收缩至</button>
                </div>
                <div style="padding:0 0 5px 0;" class="item">
                    <button onclick="position();">定位</button>
                    <button onclick="position(true);">定位并选中</button>
                    <button onclick="checked(true);">勾选</button>
                    <button onclick="checked(false);">取消勾选</button>
                    <button onclick="checked(true, true);">全部勾选</button>
                    <button onclick="checked(false, true);">全部取消勾选</button>
                    <button onclick="sortUp();">上移</button>
                    <button onclick="sortDown();">下移</button>
                </div>
                <div style="padding:0 0 5px 0;" class="item">
                    <button onclick="expandChild(true);">展开子节点</button>
                    <button onclick="expandChild(false);">收缩子节点</button>
                    <button onclick="expandChild(true, true);">展开节点及子节点</button>
                    <button onclick="expandChild(false, true);">收缩节点及子节点</button>
                </div>
                <div style="padding:0 0 5px 0;" class="item">
                    <button onclick="deleteNode();">删除</button>
                    <select id="ddlChild">
                        <option value="0">节点</option>
                        <option value="1">子节点</option>
                    </select>
                    <button onclick="moveNode();" title="appendChild">移动到</button>
                    <button onclick="moveNode(true);" title="insertBefore">插入在</button>
                    <button onclick="moveNode(true, true);" title="insertBefore(inside)">插入到</button>
                    <input type="text" id="txtInsertIndex" class="txt" style="width:40px;" title="插入到目标节点内部索引位置" maxlength="3" value="0" />
                    <label class="chb-label">
                        <input type="checkbox" value="1" id="chbDrag2" />
                        <span>模拟拖动</span>
                    </label>
                    <button onclick="sortNode();" title="仅限同级内移位排序">移位到</button>
                </div>
                <div style="padding:0 0 5px 0;" class="item">
                    <span>目标节点:</span>
                    <input type="text" id="txtDestId" class="txt" style="width:180px;" placeholder="目标NodeId" />
                </div>
            </div>
            <div>                
                <div style="padding:0 0 5px 0;" class="item">
                    <span>通道ID:</span>
                    <input type="text" id="txtPid" class="txt" style="width:60px;" />
                    <span>数量:</span>
                    <input type="text" id="txtPresetLen" class="txt" style="width:50px;" maxlength="6" />
                    <button onclick="addNode2();">新增预置点</button>
                </div>
                <div>
                    <button onclick="setHeight(1);">增加高度</button>
                    <button onclick="setHeight(-1);">减少高度</button>
                    <button onclick="setWidth(1);">增加宽度</button>
                    <button onclick="setWidth(-1);">减少宽度</button>
                </div>
            </div>
        </div>
        <div id="txt" style="margin:0;padding:5px 0;"></div>
        <div id="divGet" class="box" style="display:none;">

        </div>
    </div>
</div>
</body>
</html>
<style type="text/css">
    /*自定义样式 示例*/
    .my-tree {}
    .my-tree li .item {
        height:40px; line-height: 38px;
    }
    .my-tree li .item span.switch {height: 24px;margin-top:8px;}
    .my-tree li .item span.check {margin-top:8px;}
    .my-tree li .item .icon,.my-tree li .item .icon-open {
        width:24px;height:24px;margin-top:8px;
    }
    .my-tree li .item a.name,.my-tree li .item a.name span,.my-tree li .item span {
        height:40px;line-height:38px; color:#00f;
    }
    .my-tree li.cur > .item {}
    .my-tree li.cur > .item:hover{}


    .my-tree li > .item a.name{background:none;}
    .my-tree li > .item a.name:hover{background:#f8f8f8;border-color:#cce8ff;}

    .my-tree li.cur > .item a.name{background:none;border-color:#cce8ff;}
    .my-tree li.cur > .item a.name:hover{background:#f1f1f1;border-color:#cce8ff;}

    /*通栏自定义样式示例*/
    /*
    .my-tree {}
    .my-tree ul.box {width:100%;}
    .my-tree li, .my-tree li.node {padding: 0;width:100%;}
    .my-tree li .item {
        height:30px; line-height: 28px;width:100%;
    }
    .my-tree li .item span.switch {height:24px;margin-top:3px;}
    .my-tree li .item span.switch-none {background: none;}
    .my-tree li .item span.check {margin-top:3px;}
    .my-tree li .item .icon,.my-tree li .item .icon-open {
        width:24px;height:24px;margin-top:3px;
    }
    .my-tree li .item a.name,.my-tree li .item a.name span,.my-tree li .item span {
        height:30px;line-height:28px;
    }

    .my-tree li > .item:hover {background:#e5f3ff;cursor:pointer;}

    .my-tree li.cur > .item {background: #cce8ff;border-color: #cce8ff;}
    .my-tree li.cur > .item:hover{background: #cce8ff;border-color: #99d1ff;}

    .my-tree li.cur > .item a.name{background:none;border-color:#cce8ff;}
    .my-tree li.cur > .item a.name:hover{background:none;border-color:#cce8ff;}
*/
</style>
<script type="text/javascript" src="../oui/oui.js?1"></script>
<script type="text/javascript" src="../oui/contextmenu/oui.contextmenu.js"></script>
<script type="text/javascript" src="../oui/tree/oui.tree.js?123"></script>
<script type="text/javascript" src="dropdownlist.json"></script>
<script type="text/javascript">

    var testData1 = {
        list: [{"id":1,"name":"主控制中心","pid":0,"level":1},{"id":2,"name":"中研瑞华","pid":1,"level":2},{"id":9,"name":"浙江","pid":1,"level":2},{"id":290,"name":"上海","pid":1,"level":2},{"id":6,"name":"宁夏","pid":1,"level":2},{"id":22,"name":"广东","pid":1,"level":2},{"id":24,"name":"江西","pid":1,"level":2},{"id":35,"name":"河北","pid":1,"level":2},{"id":75,"name":"河南","pid":1,"level":2},{"id":76,"name":"山东","pid":1,"level":2},{"id":87,"name":"安徽","pid":1,"level":2},{"id":97,"name":"福建","pid":1,"level":2},{"id":100,"name":"湖南","pid":1,"level":2},{"id":131,"name":"四川","pid":1,"level":2},{"id":152,"name":"广西","pid":1,"level":2},{"id":164,"name":"湖北","pid":1,"level":2},{"id":181,"name":"江苏","pid":1,"level":2},{"id":190,"name":"山西","pid":1,"level":2},{"id":400,"name":"云南","pid":1,"level":2},{"id":412,"name":"重庆","pid":1,"level":2},{"id":416,"name":"陕西","pid":1,"level":2},{"id":503,"name":"北京","pid":1,"level":2},{"id":524,"name":"吉林","pid":1,"level":2},{"id":554,"name":"海南","pid":1,"level":2},{"id":411,"name":"上海铁路局","pid":290,"level":3},{"id":581,"name":"上海寻正智能","pid":290,"level":3},{"id":5,"name":"WMP测试","pid":2,"level":3},{"id":66,"name":"中研广汇","pid":35,"level":3},{"id":74,"name":"116测试","pid":2,"level":3},{"id":77,"name":"日照振东","pid":76,"level":3},{"id":78,"name":"310测试","pid":2,"level":3},{"id":79,"name":"对接研发测试","pid":2,"level":3},{"id":83,"name":"杭州华进","pid":9,"level":3},{"id":85,"name":"咸亨国际科研中心","pid":9,"level":3},{"id":86,"name":"余姚城管","pid":9,"level":3},{"id":103,"name":"101测试","pid":2,"level":3},{"id":104,"name":"百盛源电力","pid":35,"level":3},{"id":106,"name":"A-815测试","pid":2,"level":3},{"id":136,"name":"青岛鸿升沃达","pid":76,"level":3},{"id":140,"name":"福建四创","pid":97,"level":3},{"id":150,"name":"青岛亿信联盟","pid":76,"level":3},{"id":157,"name":"姚然","pid":35,"level":3},{"id":165,"name":"奋进电力","pid":164,"level":3},{"id":168,"name":"防外破演示","pid":2,"level":3},{"id":170,"name":"浙江信电","pid":9,"level":3},{"id":174,"name":"朗天通信","pid":131,"level":3},{"id":182,"name":"华创","pid":181,"level":3},{"id":206,"name":"莒县人民法院","pid":76,"level":3},{"id":212,"name":"710测试","pid":2,"level":3},{"id":218,"name":"福建特检院","pid":97,"level":3},{"id":233,"name":"815临时","pid":2,"level":3},{"id":234,"name":"安客讯","pid":181,"level":3},{"id":238,"name":"咸亨物联网中心","pid":9,"level":3},{"id":246,"name":"余姚GPS","pid":9,"level":3},{"id":262,"name":"美兰机场","pid":131,"level":3},{"id":264,"name":"京华","pid":181,"level":3},{"id":271,"name":"达州","pid":131,"level":3},{"id":288,"name":"720测试","pid":2,"level":3},{"id":291,"name":"威斯莱克","pid":290,"level":3},{"id":293,"name":"金塘高速","pid":9,"level":3},{"id":296,"name":"青岛九瑞汽车","pid":76,"level":3},{"id":300,"name":"宣化区指挥中心","pid":35,"level":3},{"id":301,"name":"张家口","pid":35,"level":3},{"id":302,"name":"宁波气象局","pid":9,"level":3},{"id":312,"name":"郑州热力总公司","pid":75,"level":3},{"id":313,"name":"江苏惠海船舶","pid":181,"level":3},{"id":332,"name":"郑煤集团","pid":75,"level":3},{"id":337,"name":"故障排查","pid":2,"level":3},{"id":338,"name":"安卓测试","pid":2,"level":3},{"id":341,"name":"烟台业达集团","pid":76,"level":3},{"id":343,"name":"810测试","pid":2,"level":3},{"id":349,"name":"常州市市场监督管理局","pid":181,"level":3},{"id":353,"name":"南通五健","pid":181,"level":3},{"id":380,"name":"软件评测","pid":2,"level":3},{"id":386,"name":"28181","pid":2,"level":3},{"id":394,"name":"世纪航信","pid":164,"level":3},{"id":397,"name":"深圳","pid":22,"level":3},{"id":399,"name":"711测试","pid":2,"level":3},{"id":401,"name":"火星人","pid":400,"level":3},{"id":405,"name":"象山气象屏","pid":9,"level":3},{"id":406,"name":"嘉禾通达","pid":152,"level":3},{"id":408,"name":"青岛悦峰","pid":76,"level":3},{"id":413,"name":"郫县水务","pid":412,"level":3},{"id":417,"name":"军盾","pid":416,"level":3},{"id":419,"name":"柳州机场","pid":152,"level":3},{"id":424,"name":"智能安防机器人","pid":76,"level":3},{"id":430,"name":"815_未出货","pid":2,"level":3},{"id":431,"name":"国中新创","pid":416,"level":3},{"id":442,"name":"东部新城城市管理中心","pid":9,"level":3},{"id":443,"name":"内部监控","pid":2,"level":3},{"id":444,"name":"车载主机","pid":2,"level":3},{"id":484,"name":"义乌水务局","pid":9,"level":3},{"id":485,"name":"科鼎机电","pid":35,"level":3},{"id":488,"name":"中煤安科","pid":190,"level":3},{"id":492,"name":"唐山市气象局","pid":35,"level":3},{"id":495,"name":"浙江石化","pid":9,"level":3},{"id":496,"name":"布控球","pid":2,"level":3},{"id":501,"name":"912测试","pid":2,"level":3},{"id":504,"name":"北京国网信通","pid":503,"level":3},{"id":509,"name":"宁波交通检测","pid":9,"level":3},{"id":519,"name":"无为水务局","pid":87,"level":3},{"id":525,"name":"油田通信","pid":524,"level":3},{"id":535,"name":"徐州科源","pid":181,"level":3},{"id":537,"name":"青岛索尔汽车","pid":76,"level":3},{"id":542,"name":"江苏星诺","pid":181,"level":3},{"id":545,"name":"北斗院物联","pid":76,"level":3},{"id":551,"name":"普望（上海）信息咨询有限公司","pid":131,"level":3},{"id":553,"name":"宁波送变电建设有限公司","pid":9,"level":3},{"id":558,"name":"新航致远","pid":131,"level":3},{"id":559,"name":"湖南警翼信安智能科技","pid":100,"level":3},{"id":562,"name":"石家庄市一方科技有限公司","pid":35,"level":3},{"id":563,"name":"青岛三利中德","pid":76,"level":3},{"id":567,"name":"中咨公路项目","pid":503,"level":3},{"id":569,"name":"西安圣点世纪科技有限公司","pid":416,"level":3},{"id":574,"name":"正云科技","pid":503,"level":3},{"id":575,"name":"云南文鼎","pid":400,"level":3},{"id":577,"name":"225测试","pid":2,"level":3},{"id":578,"name":"索福尔汽车","pid":76,"level":3},{"id":580,"name":"威海杜","pid":76,"level":3},{"id":584,"name":"河北天创","pid":35,"level":3},{"id":585,"name":"西安峪北","pid":416,"level":3},{"id":586,"name":"山西华承","pid":190,"level":3},{"id":587,"name":"程旭","pid":35,"level":3},{"id":588,"name":"无锡市高桥检测科技","pid":181,"level":3},{"id":589,"name":"北京酷成长","pid":503,"level":3},{"id":594,"name":"电力卫士","pid":181,"level":3},{"id":596,"name":"秦滨高速","pid":35,"level":3},{"id":597,"name":"武汉擎安云","pid":164,"level":3},{"id":598,"name":"河南建功","pid":75,"level":3},{"id":600,"name":"宁波智享智能","pid":9,"level":3},{"id":603,"name":"蜀锐电话","pid":131,"level":3},{"id":609,"name":"山东拓远项目管理公司","pid":76,"level":3},{"id":610,"name":"康振电气","pid":181,"level":3},{"id":611,"name":"恋茶文化","pid":152,"level":3},{"id":613,"name":"昱鑫测控","pid":164,"level":3},{"id":615,"name":"赣州机场消防","pid":152,"level":3},{"id":618,"name":"浙江龙驰建设","pid":9,"level":3},{"id":620,"name":"上海思允","pid":290,"level":3},{"id":621,"name":"年泰电力","pid":87,"level":3},{"id":627,"name":"南京奥联信息","pid":181,"level":3},{"id":629,"name":"江苏柏勋科技","pid":181,"level":3},{"id":632,"name":"苏能电力工程","pid":181,"level":3},{"id":633,"name":"天勤网络","pid":181,"level":3},{"id":634,"name":"河北联强","pid":35,"level":3},{"id":640,"name":"衡水市安捷电子","pid":35,"level":3},{"id":643,"name":"郑州祥和集团","pid":75,"level":3},{"id":650,"name":"宁波天弘电力","pid":9,"level":3},{"id":652,"name":"遵义机场","pid":152,"level":3},{"id":653,"name":"安徽天元","pid":87,"level":3},{"id":656,"name":"郑州优碧科技","pid":75,"level":3},{"id":661,"name":"沈阳永成烽火","pid":76,"level":3},{"id":678,"name":"宁波瑞奥","pid":9,"level":3},{"id":684,"name":"如东县住建局","pid":181,"level":3},{"id":685,"name":"重庆安之然","pid":412,"level":3},{"id":691,"name":"甘肃省电力应急中心","pid":35,"level":3},{"id":693,"name":"宁波交投三分公司","pid":9,"level":3},{"id":694,"name":"珞珈天铭","pid":164,"level":3},{"id":714,"name":"宁波高等级公司养护","pid":9,"level":3},{"id":718,"name":"金童矿区","pid":9,"level":3},{"id":722,"name":"象山城管","pid":9,"level":3},{"id":726,"name":"防外破视频装置","pid":87,"level":3},{"id":730,"name":"818测试","pid":2,"level":3},{"id":732,"name":"安徽瞳声","pid":87,"level":3},{"id":748,"name":"十二月份发的货","pid":2,"level":3},{"id":765,"name":"4.10测试","pid":2,"level":3},{"id":767,"name":"陕西华宏隆兴","pid":416,"level":3},{"id":771,"name":"大理宾川水务局","pid":400,"level":3},{"id":772,"name":"i1-test","pid":2,"level":3},{"id":773,"name":"象山影视城","pid":9,"level":3},{"id":779,"name":"EMC-TEST","pid":2,"level":3},{"id":780,"name":"国标演示测试","pid":2,"level":3},{"id":781,"name":"机芯ping测试","pid":2,"level":3},{"id":782,"name":"天能电力","pid":35,"level":3},{"id":785,"name":"4月份测试","pid":2,"level":3},{"id":789,"name":"833测试","pid":2,"level":3},{"id":790,"name":"优尔电子","pid":87,"level":3},{"id":792,"name":"2021/6/16 10个矮球机","pid":2,"level":3},{"id":797,"name":"南京悠阔","pid":181,"level":3},{"id":801,"name":"30+3普通球机带音频","pid":2,"level":3},{"id":805,"name":"9月7号T型测试","pid":2,"level":3},{"id":812,"name":"2021/12/16-10套","pid":2,"level":3},{"id":813,"name":"两个带AI模块球机","pid":2,"level":3},{"id":819,"name":"农业科学院腰果研究中心","pid":554,"level":3},{"id":821,"name":"2022/3/2-920主板3个","pid":2,"level":3},{"id":826,"name":"20220331测试3台T型云台","pid":2,"level":3},{"id":827,"name":"2507N黑球测试","pid":2,"level":3},{"id":828,"name":"2507N测试用的球机","pid":2,"level":3},{"id":829,"name":"江苏移动","pid":181,"level":3},{"id":848,"name":"160套测试5个","pid":2,"level":3},{"id":860,"name":"铜陵万通","pid":87,"level":3},{"id":877,"name":"电网","pid":9,"level":3},{"id":892,"name":"维修","pid":2,"level":3},{"id":895,"name":"20230320-三个小球机","pid":2,"level":3},{"id":897,"name":"850主板发常德","pid":2,"level":3},{"id":899,"name":"I1定制测试","pid":2,"level":3},{"id":900,"name":"大华测试","pid":9,"level":3},{"id":901,"name":"海康硬盘录像机","pid":2,"level":3},{"id":903,"name":"象山造船厂","pid":9,"level":3},{"id":907,"name":"20230509-15片V2-850主板","pid":2,"level":3},{"id":910,"name":"测试枪机","pid":2,"level":3},{"id":941,"name":"测试112","pid":290,"level":3},{"id":942,"name":"测试113","pid":290,"level":3},{"id":595,"name":"青岛海运","pid":296,"level":4},{"id":607,"name":"测试","pid":296,"level":4},{"id":92,"name":"613避险车道","pid":77,"level":4},{"id":105,"name":"智能安全帽","pid":104,"level":4},{"id":133,"name":"电莞电力","pid":85,"level":4},{"id":137,"name":"甘肃省环境应急与事故调查中心","pid":136,"level":4},{"id":138,"name":"客户b","pid":136,"level":4},{"id":139,"name":"客户C","pid":136,"level":4},{"id":142,"name":"检测站","pid":136,"level":4},{"id":151,"name":"建筑","pid":150,"level":4},{"id":166,"name":"奋进测试","pid":165,"level":4},{"id":169,"name":"车载","pid":77,"level":4},{"id":172,"name":"安顺水利局","pid":140,"level":4},{"id":175,"name":"应急指挥","pid":174,"level":4},{"id":185,"name":"铁路桥","pid":77,"level":4},{"id":196,"name":"保山水利局","pid":140,"level":4},{"id":213,"name":"杭州市局禁毒大队","pid":83,"level":4},{"id":214,"name":"迎宾大桥","pid":77,"level":4},{"id":235,"name":"akx01","pid":234,"level":4},{"id":239,"name":"张家界机场","pid":238,"level":4},{"id":240,"name":"akx02","pid":234,"level":4},{"id":263,"name":"机场","pid":262,"level":4},{"id":270,"name":"上海厉基","pid":234,"level":4},{"id":273,"name":"akx03","pid":234,"level":4},{"id":298,"name":"客户A","pid":165,"level":4},{"id":317,"name":"前景光电","pid":296,"level":4},{"id":318,"name":"手持2","pid":296,"level":4},{"id":319,"name":"手持3","pid":296,"level":4},{"id":329,"name":"akx05","pid":234,"level":4},{"id":331,"name":"黄花机场","pid":85,"level":4},{"id":335,"name":"茶陵县","pid":140,"level":4},{"id":366,"name":"长热集团","pid":296,"level":4},{"id":369,"name":"2017年9套监控","pid":302,"level":4},{"id":370,"name":"宁夏2017","pid":165,"level":4},{"id":371,"name":"客户B","pid":165,"level":4},{"id":373,"name":"银川","pid":165,"level":4},{"id":378,"name":"定位设备","pid":66,"level":4},{"id":387,"name":"应急救援","pid":136,"level":4},{"id":389,"name":"2017年球机","pid":302,"level":4},{"id":403,"name":"福建电力公司","pid":165,"level":4},{"id":407,"name":"消防大队","pid":406,"level":4},{"id":420,"name":"沧源水利局","pid":140,"level":4},{"id":422,"name":"黄浦水利局","pid":140,"level":4},{"id":426,"name":"奔驰指挥车","pid":296,"level":4},{"id":427,"name":"演示","pid":296,"level":4},{"id":428,"name":"晋城水务局","pid":136,"level":4},{"id":435,"name":"313-3-3","pid":165,"level":4},{"id":441,"name":"瑞风消防指挥车","pid":296,"level":4},{"id":449,"name":"上海工商","pid":234,"level":4},{"id":450,"name":"青海","pid":165,"level":4},{"id":451,"name":"上海","pid":165,"level":4},{"id":454,"name":"福建","pid":165,"level":4},{"id":456,"name":"河北","pid":165,"level":4},{"id":458,"name":"湖北","pid":165,"level":4},{"id":461,"name":"浙江","pid":165,"level":4},{"id":463,"name":"河南","pid":165,"level":4},{"id":468,"name":"山东","pid":165,"level":4},{"id":474,"name":"江西","pid":165,"level":4},{"id":493,"name":"曹妃甸气象局","pid":492,"level":4},{"id":494,"name":"乐亭县气象局","pid":492,"level":4},{"id":499,"name":"山东电力演示","pid":165,"level":4},{"id":502,"name":"淄博桓台县供电公司","pid":165,"level":4},{"id":508,"name":"智能安全帽","pid":77,"level":4},{"id":510,"name":"安全帽","pid":66,"level":4},{"id":511,"name":"济南人防","pid":296,"level":4},{"id":512,"name":"鼎文学校项目","pid":618,"level":4},{"id":538,"name":"金华创业机电设备","pid":537,"level":4},{"id":539,"name":"样车","pid":537,"level":4},{"id":544,"name":"菠萝救援队","pid":296,"level":4},{"id":546,"name":"客户","pid":545,"level":4},{"id":561,"name":"四川","pid":296,"level":4},{"id":564,"name":"A","pid":563,"level":4},{"id":572,"name":"兰州机场","pid":238,"level":4},{"id":579,"name":"A","pid":578,"level":4},{"id":617,"name":"海曙气象局","pid":302,"level":4},{"id":638,"name":"8套","pid":537,"level":4},{"id":651,"name":"高压视频","pid":650,"level":4},{"id":662,"name":"千喜救援队","pid":296,"level":4},{"id":668,"name":"创新研究院","pid":296,"level":4},{"id":680,"name":"张掖市","pid":691,"level":4},{"id":681,"name":"4台黄色","pid":684,"level":4},{"id":686,"name":"北京卫星发射中心","pid":296,"level":4},{"id":687,"name":"3套白色","pid":501,"level":4},{"id":692,"name":"陇南市","pid":691,"level":4},{"id":704,"name":"2个红色","pid":501,"level":4},{"id":707,"name":"驭道","pid":627,"level":4},{"id":708,"name":"携奥","pid":627,"level":4},{"id":709,"name":"奥联","pid":627,"level":4},{"id":711,"name":"国标测试","pid":694,"level":4},{"id":712,"name":"669592","pid":694,"level":4},{"id":715,"name":"天津恒安","pid":296,"level":4},{"id":716,"name":"青岛应急管理局","pid":296,"level":4},{"id":724,"name":"669504","pid":694,"level":4},{"id":735,"name":"西周中队","pid":722,"level":4},{"id":736,"name":"大徐中队","pid":722,"level":4},{"id":737,"name":"新桥中队","pid":722,"level":4},{"id":741,"name":"26个带音频和电池","pid":748,"level":4},{"id":750,"name":"发一台维修的机器至东北","pid":748,"level":4},{"id":751,"name":"一台2507机芯","pid":748,"level":4},{"id":752,"name":"济宁国祥投资有限公司","pid":296,"level":4},{"id":753,"name":"2020.12.09发4","pid":748,"level":4},{"id":754,"name":"2020.12.11.发13","pid":748,"level":4},{"id":755,"name":"20201211发刘星建2个","pid":748,"level":4},{"id":757,"name":"2020 12 16发","pid":748,"level":4},{"id":758,"name":"饶东","pid":714,"level":4},{"id":759,"name":"南接线","pid":714,"level":4},{"id":760,"name":"20201219维修常德","pid":748,"level":4},{"id":761,"name":"20201220 3个","pid":748,"level":4},{"id":763,"name":"20201222发9个长沙","pid":748,"level":4},{"id":764,"name":"20201222发5个2507有开关","pid":722,"level":4},{"id":766,"name":"20201228发15个","pid":748,"level":4},{"id":774,"name":"西宁市城西区疾病预防控制中心","pid":296,"level":4},{"id":777,"name":"在线监测装置","pid":726,"level":4},{"id":778,"name":"视频监控","pid":726,"level":4},{"id":784,"name":"2628测试","pid":694,"level":4},{"id":794,"name":"20210701","pid":537,"level":4},{"id":795,"name":"8路NVR","pid":537,"level":4},{"id":798,"name":"象鼻岭水电站","pid":797,"level":4},{"id":799,"name":"20210714","pid":296,"level":4},{"id":800,"name":"akx09","pid":234,"level":4},{"id":802,"name":"4G手持单兵22","pid":537,"level":4},{"id":803,"name":"输电线路在线监测","pid":726,"level":4},{"id":804,"name":"烟台中石化工","pid":296,"level":4},{"id":806,"name":"展会","pid":296,"level":4},{"id":808,"name":"上海","pid":694,"level":4},{"id":809,"name":"静乐县自来水公司","pid":296,"level":4},{"id":811,"name":"20211122-13pc","pid":726,"level":4},{"id":815,"name":"通化恒泰热力","pid":296,"level":4},{"id":818,"name":"20220125-1pc","pid":296,"level":4},{"id":824,"name":"20220318-8pc","pid":726,"level":4},{"id":830,"name":"镇江","pid":829,"level":4},{"id":831,"name":"无锡","pid":829,"level":4},{"id":832,"name":"苏州","pid":829,"level":4},{"id":833,"name":"徐州","pid":829,"level":4},{"id":834,"name":"连云港","pid":829,"level":4},{"id":835,"name":"淮安","pid":829,"level":4},{"id":836,"name":"常州","pid":829,"level":4},{"id":837,"name":"扬州","pid":829,"level":4},{"id":838,"name":"宿迁","pid":829,"level":4},{"id":839,"name":"南通","pid":829,"level":4},{"id":840,"name":"盐城","pid":829,"level":4},{"id":841,"name":"南京","pid":829,"level":4},{"id":842,"name":"泰州","pid":829,"level":4},{"id":844,"name":"涞水消防大队","pid":296,"level":4},{"id":846,"name":"20220701-4pc","pid":726,"level":4},{"id":847,"name":"20220620-26pc","pid":726,"level":4},{"id":850,"name":"智能走板","pid":650,"level":4},{"id":852,"name":"SongYgdgs","pid":694,"level":4},{"id":854,"name":"青州华润燃气","pid":296,"level":4},{"id":855,"name":"山东滨华新材料","pid":296,"level":4},{"id":856,"name":"穿好","pid":714,"level":4},{"id":857,"name":"慈余","pid":714,"level":4},{"id":858,"name":"三门湾","pid":714,"level":4},{"id":859,"name":"象山港","pid":714,"level":4},{"id":862,"name":"余姚矿山","pid":170,"level":4},{"id":863,"name":"维修好后发回去设备","pid":694,"level":4},{"id":864,"name":"20220826-40pc","pid":726,"level":4},{"id":865,"name":"20220913-27pc","pid":726,"level":4},{"id":866,"name":"202209","pid":726,"level":4},{"id":867,"name":"20220909-1pc","pid":726,"level":4},{"id":872,"name":"20220930-12pc","pid":726,"level":4},{"id":873,"name":"20221008-6pc","pid":726,"level":4},{"id":878,"name":"20221103-1pc","pid":296,"level":4},{"id":888,"name":"20230106-5pc","pid":726,"level":4},{"id":893,"name":"i1接入-机芯","pid":781,"level":4},{"id":894,"name":"远程控制","pid":781,"level":4},{"id":906,"name":"GB28181","pid":726,"level":4},{"id":909,"name":"其它","pid":714,"level":4},{"id":197,"name":"腾冲县","pid":196,"level":5},{"id":199,"name":"龙陵县","pid":196,"level":5},{"id":200,"name":"隆阳区","pid":196,"level":5},{"id":201,"name":"昌宁县","pid":196,"level":5},{"id":255,"name":"客户E","pid":139,"level":5},{"id":258,"name":"施甸县","pid":196,"level":5},{"id":295,"name":"whjd","pid":235,"level":5},{"id":334,"name":"普定县","pid":172,"level":5},{"id":382,"name":"保山球机","pid":196,"level":5},{"id":452,"name":"崇明","pid":451,"level":5},{"id":453,"name":"嘉定","pid":451,"level":5},{"id":455,"name":"南平","pid":454,"level":5},{"id":457,"name":"廊坊","pid":456,"level":5},{"id":459,"name":"十堰","pid":458,"level":5},{"id":460,"name":"沧州","pid":456,"level":5},{"id":462,"name":"东阳","pid":461,"level":5},{"id":464,"name":"中牟","pid":463,"level":5},{"id":465,"name":"郑州","pid":463,"level":5},{"id":466,"name":"保定","pid":456,"level":5},{"id":467,"name":"唐山","pid":456,"level":5},{"id":469,"name":"菏泽","pid":468,"level":5},{"id":470,"name":"新乡","pid":463,"level":5},{"id":471,"name":"濮阳","pid":463,"level":5},{"id":472,"name":"邯郸","pid":456,"level":5},{"id":473,"name":"武义","pid":461,"level":5},{"id":475,"name":"上饶","pid":474,"level":5},{"id":476,"name":"磐安","pid":461,"level":5},{"id":477,"name":"邢台","pid":456,"level":5},{"id":478,"name":"杭州","pid":461,"level":5},{"id":479,"name":"衡水","pid":456,"level":5},{"id":480,"name":"石家庄","pid":456,"level":5},{"id":481,"name":"秦皇岛","pid":456,"level":5},{"id":810,"name":"2021/11/11-436套设备1台","pid":863,"level":5},{"id":825,"name":"2022/3/18-436套设备","pid":863,"level":5},{"id":851,"name":"江苏泰州","pid":850,"level":5},{"id":853,"name":"GQSP","pid":852,"level":5},{"id":861,"name":"湖北输检","pid":850,"level":5},{"id":868,"name":"20220903","pid":863,"level":5},{"id":869,"name":"20220915","pid":863,"level":5},{"id":874,"name":"20221010","pid":863,"level":5},{"id":876,"name":"20221011","pid":863,"level":5},{"id":879,"name":"20221121","pid":863,"level":5},{"id":880,"name":"20221126","pid":863,"level":5},{"id":881,"name":"202212-常州10pc","pid":863,"level":5},{"id":883,"name":"202212月份 5套436的设备","pid":863,"level":5},{"id":884,"name":"20221228","pid":863,"level":5},{"id":885,"name":"20230103一台436设备","pid":863,"level":5},{"id":886,"name":"20230106-10台长沙设备","pid":863,"level":5},{"id":889,"name":"20230109-436套7pc","pid":863,"level":5},{"id":890,"name":"20230203-怀化","pid":863,"level":5},{"id":891,"name":"20230222-怀化","pid":863,"level":5},{"id":896,"name":"杭州演示","pid":850,"level":5},{"id":902,"name":"20230421-衡阳4台","pid":863,"level":5},{"id":904,"name":"20230505-10台436套","pid":863,"level":5}]
    };

    $.console.log(testData1.list);

    var currentInput = $I('txtNodeId');

    window.onload = function () {
        $('#txtNodeId,#txtDestId').click(function (ev, i, obj) {
            currentInput = obj;
        });
    };

    var TreeId = 'tree';

    function expandLevel(expand) {
        var linkage = $('#chbLinkage').checked(),
            reverse = $('#chbReverse').checked(),
            level = $('#ddlLevel2').val().toInt();
        $.console.log('expandLevel:', level, linkage, reverse, expand);
        //$.tree() 空参数 可以获取到第一个非空的树，如果当前页面只有一个树，可以这样获取
        $.tree(TreeId).expandLevel(level, linkage, reverse, expand);
    }

    function expandType(expand) {
        var linkage = $('#chbLinkage').checked(),
            type = $('#ddlType2').val();
        $.tree(TreeId).expandType(type, linkage, expand);
    }

    function expandAll(expand) {
        $.tree(TreeId).expandAll(expand);
    }

    function addNode1() {
        var items = [{id:5,name:'部门五',pid:1},{id:6,name:'部门六',pid:1},{id:7,name:"部门七",pid:5}],
            par = {ptype: 'department',type: 'department'};

        $.tree(TreeId).add(items, par);
    }
    function addNode2() {
        var pid = $('#txtPid').val(),
            len = $('#txtPresetLen').val().toInt(1),
            num,
            par = {type: 'preset', ptype: 'camera'},
            items = [],
            nid = $.tree(TreeId).nid(pid, 'camera'),
            node = $.tree(TreeId).node(nid);

        if (!pid || !len || !node) {
            return false;
        }

        num = node.childs.length;

        for (var i = 0; i < len; i++) {
            items.push({id: pid + '_' + (num + i + 1), name: '预置点' + (num + i + 1), pid: pid});
        }
        $.tree(TreeId).add(items, par);
    }

    function setHeight(rate) {
        //$('#tree').height($('#tree').height() + 50 * rate);
        $.tree().resize(50 * rate, true);
    }
    function setWidth(rate) {
        $('#tree').width($('#tree').width() + 50 * rate);
        $.tree().resize();
    }

    function expand(linkage) {
        var nid = $('#txtNodeId').val().trim();
        $.tree(TreeId).expand(nid, linkage);
    }
    function collapse(linkage) {
        var nid = $('#txtNodeId').val().trim();
        $.tree(TreeId).collapse(nid, linkage);
    }

    function expandChild(expand, self) {
        var nid = $('#txtNodeId').val().trim(),
            linkage = $('#chbLinkage').checked();
        $.tree(TreeId).expandChild(nid, linkage, self, 'unit,device', expand);
    }

    function position(selected) {
        var nid = $('#txtNodeId').val().trim();
        $.tree(TreeId).position(nid, selected);
    }

    function checked(checked, isAll) {
        if (isAll) {
            $.tree(TreeId).checked(true, checked, 'unit');
        } else {            
            var nid = $('#txtNodeId').val().trim();
            $.tree(TreeId).checked(nid, checked);
        }
    }

    function deleteNode() {
        var nid = $('#txtNodeId').val().trim(),
            child = $('#ddlChild').val().toInt();

        $.tree(TreeId)[child ? 'deleteChild' : 'delete'](nid);
    }

    function moveNode(insert, inside) {
        var nid = $('#txtNodeId').val().trim(),
            dest = $('#txtDestId').val().trim(),
            child = $('#ddlChild').val().toInt(),
            index = $('#txtInsertIndex').val().toInt();

        $.tree(TreeId)[child ? 'moveChild' : 'move'](nid, dest, insert, inside, index);
    }

    function sortUp() {
        var nid = $('#txtNodeId').val().trim();
        $.tree(TreeId).sortUp(nid);
    }

    function sortDown() {
        var nid = $('#txtNodeId').val().trim();
        $.tree(TreeId).sortDown(nid);
    }
    function sortNode() {
        var nid = $('#txtNodeId').val().trim(),
            dest = $('#txtDestId').val().trim(),
            drag = $('#chbDrag2').checked();

        $.tree(TreeId).sortNode(nid, dest, function (node, num, idx) {
            $.console.log('sortNode', node, num, idx);
        }, drag);
    }

    function getTestData(resolve) {
        $.console.log('getTestData:0');
        var data = treedata;
        if ($.isFunction(resolve)) {
            $.console.log('getTestData:1');
            resolve(data);
        }
        $.console.log('getTestData:2');
    }

    var cache = {};

    function test(type) {
        TreeId = $('#ddlTreeId').val().trim();

        var arr = $N('chbData'), keys = {};
        for (var i = 0; i < arr.length; i++) {
            if (arr[i].checked) {
                keys[arr[i].value] = 1;
            }
        }

        var trees = [
            keys['root'] ? {type:'root',key:'datas'} : undefined,
            keys['unit'] ? {type:'unit',key:'units',name:'目录'} : undefined,
            keys['device'] ? {type:'device',key:'devices',ptype:'unit',name:'设备'} : undefined,
            keys['camera'] ? {type:'camera',key:'cameras',ptype:'device',name:'通道'} : undefined,
            keys['department'] ? {type:'department',key:'departments'} : undefined,
            keys['person'] ? {type:'helmet',key:'persons',ptype:'department'} : undefined
        ];

        $.console.log('trees:', trees);

        var datas = [treedata, treedata2, getTestData, testData1];

        var html = ['begin: ' + new Date().format('HHmmss.fff') + ', '],
            data = datas[type],
            skin = $('#ddlSkin').val(),
            openLevel = $('#ddlLevel').val().toInt(),
            keepStatus = $('#chbKeepStatus').checked(),
            keepCookie = $('#chbKeepCookie').checked(),
            showCheck = $('#chbCheck').checked(),
            showLine = $('#chbLine').checked(),
            hoverLine = $('#chbHoverLine').checked(),
            showIcon = $('#chbIcon').checked(),
            showType = $('#chbType').checked(),
            showStatus = $('#chbStatus').checked(),
            showCount = $('#chbCount').checked(),
            showDesc = $('#chbDesc').checked(),
            showButton = $('#chbButton').checked(),
            showBottom = $('#chbBottom').checked(),
            bottomAlign = $('#ddlBottomAlign').val(),
            showMove = $('#chbMove').checked(),
            showSearch = $('#chbSearch').checked(),
            realSearch = $('#chbRealSearch').checked(),
            clearSearch = $('#chbClearSearch').checked(),
            showTitle = $('#chbTitle').checked(),
            showInfo = $('#chbInfo').checked(),
            moveAble = $('#chbMoveAble').checked(),
            dragAble = $('#chbDragAble').checked(),
            dragMove = $('#chbDragMove').checked(),
            dragSize = $('#chbDragSize').checked(),
            switchIcon = $('#ddlSwitch').val(),
            clickExpand = $('#chbClickExpand').checked(),
            clickChecked = $('#chbClickChecked').checked(),
            dynamicCamera = $('#chbCamera').checked(),
            dynamic = $('#chbDynamic').checked(),
            callbackLevel = $('#chbCallbackLevel').checked(),
            onlyOpenOne = $('#chbOnlyOpenOne').checked(),
            fullWidth = $('#chbFullWidth').checked(),
            highHeight = $('#chbHighHeight').checked(),
            treeMenu = $('#chbTreeMenu').checked(),
            rightSwitch = $('#chbRightSwitch').checked(),
            customCss = $('#chbCustomCss').checked(),
            showScrollIcon = true;

            $.console.log('showStatus:', showStatus);

        if ($.isObject(data) && data.units) {
            data.units[0].desc = new Date().getTime();
            //data.units[0].showType = true;
            //data.units[0].icon = {path: 'imgs/tree/area.png'};
        }
        $.tree(TreeId, {
            target: TreeId === 'unit' ? 'unit' : null,
            //position: 'top',
            //positionFixed: true,
            //boxHeight: 500,
            skin: skin, 
            async: true, 
            keepStatus: keepStatus,
            keepCookie: keepCookie,
            onlyOpenOne: onlyOpenOne,
            debug: true,
            trees: trees,
            data: data,
            switch: switchIcon,
            leaf: true,
            leafType: 'camera',
            //dynamic: 3,
            dynamic: dynamic,
            //指定要动态加载子节点的数据类型
            dynamicTypes: ['device', 'camera'],
            //指定为被动态加载的数据类型
            dynamicDatas: dynamicCamera ? 'camera' : '',
            //指定可选中/返回的数据类型，若未指定，则所有都可返回
            returnTypes: ['unit', 'device', 'camera'],
            //returnTypes: ['device', 'camera'],
            //返回的数据值字段
            valueFields: ['type', 'id', 'code'],
            //默认值，用于还原
            defaultValue: {id:12345},
            //openLevel: 1,
            //openType: 'unit',
            openLevel: openLevel,
            //checkbox: true,
            showCheck: showCheck,
            showLine: showLine,
            hoverLine: hoverLine,
            fullWidth: fullWidth,
            highHeight: highHeight,
            customCss: customCss ? 'my-tree' : '',
            treeMenu: treeMenu,
            rightSwitch: rightSwitch,
            showIcon: showIcon,
            showType: showType,
            showStatus: showStatus,
            showCount: showCount,
            //hideCountZero: true,
            showDesc: showDesc,
            showButton: showButton,
            showBottom: showBottom,
            bottomAlign: bottomAlign,
            showScrollIcon: showScrollIcon,
            showMove: showMove,
            moveAble: moveAble,
            dragAble: dragAble,
            dragMove: dragMove,
            dragSize: dragSize,
            buttonConfig: {
                types: ['unit','device']
                //types: ['camera']
            },
            /*bottomConfig: {
                names: ['查询', '关闭'],
                count: 2,
                buttons: [
                    {key:'ok',name:'是',primary:true, func:function(tree) {
                        console.log('yes-func', tree);
                    }},
                    {key:'cancel',name:'否'}
                ]
            },
            */
            showTitle: showTitle,
            showInfo: showInfo,
            showSearch: showSearch,
            clearSearch: clearSearch,
            realSearch: realSearch,
            /*searchCallback: function (tree, keywords, resolve) {
                var nodes = [], j = 0;
                for (var k in tree.cache.nodes) {
                    var n = tree.cache.nodes[k];
                    if (n.data.name.indexOf(keywords) > -1) {
                        nodes.push(n);
                        j++;
                    }
                    if (j > 5) {
                        break;
                    }
                }
                resolve(tree, nodes);
            },*/
            clickExpand: clickExpand,
            //点击切换时，切换的方式：toggle, true, false
            //toggle等同于undefined
            clickExpanded: 'toggle',
            clickChecked: clickChecked,
            callbackLevel: callbackLevel,
            //仅用于IE浏览器节点内容最小宽度设置
            //IE浏览器不支持width:max-content,无奈之下只能特殊定制处理
            //minWidth: 300,
            complete: function (tree) {
                $('#divOper').show();
                $('#divGet').show();
                
                console.log('$.tree(undefined):', $.tree());
                console.log('$.tree(undefined):', $.tree('1324'));
                console.log('$.tree(0):', $.tree(0));
                console.log('$.tree(1):', $.tree(1));
                console.log('$.tree(2):', $.tree(2));

                html.push('finish: ' + new Date().format('HHmmss.fff') + '<br />');
                console.log('complete:', tree.id, tree.cache);
                $('#txt').html(html.concat([
                    'nodes:', tree.cache.count, ', level:', tree.cache.level + 1, ', timeout:', tree.cache.timeout, 'ms'
                ]).join(''));
                /*
                window.setTimeout(function() {
                    tree.updateIcon('device_7280,device_7155', {status:'on'}, true);
                    tree.icon('device_7151', {status:'on'}, true);
                    tree.updateStatus('device_7152', 'on', true);
                    $.tree(TreeId).updateIcon('camera_7759', {status:'play'});
                    $.tree.updateIcon(TreeId, 'camera_7760', {status:'play'});
                    tree.text('device_7153', '204488设备');
                }, 2000);
                
                window.setTimeout(function() {
                    tree.selected(['unit_826', 'unit_343', 'unit_780'], true)
                        .checked(['unit_826', 'unit_343'])
                        //.position('unit_343')
                        //.collapse(2, 'unit');
                }, 2500);
                
                window.setTimeout(function() {
                    tree//.selected([826, 343, 780], 'unit', true)
                        .checked(['unit_826', 'unit_343'])
                        .expand(2, 'unit')
                        //.position('unit_567', true)
                        //.collapse(2, 'unit');
                }, 3000);
                */

                //window.setTimeout(function() { tree.expandType('unit', true, true); }, 200);
                //window.setTimeout(function() { tree.collapseType('device', true); }, 20);

                //window.setTimeout(function() { $.tree.expandAll(TreeId); }, 20);
                //window.setTimeout(function() { tree.expandAll(); }, 20);
                //window.setTimeout(function() { tree.collapseAll(); }, 20);

                //window.setTimeout(function() { $.tree.expand(TreeId, 290, 'unit'); }, 20);
                //window.setTimeout(function() { tree.expand(190, 'unit'); }, 20);

                //window.setTimeout(function() { tree.expandLevel(2, true, true); }, 20);
            },
            callback: function (node, tree, ev) {
                $.console.log('callback:', node, tree, ev);
            },
            onclick: function (node, tree, ev) {
                node.self();
                if (!cache['node']) {
                    cache['node'] = node;
                } else {
                    cache['node'].self();
                }

                $.console.log('focus:', document.querySelector('.txt-focus'));

                if (currentInput) {
                    currentInput.value = node.id;
                }

                $.console.log('onclick', tree.id, ev, node, node.childs);
                
                $.console.log('getChecked0:', tree.getChecked());
                $.console.log('getChecked1:', tree.getChecked('data'));
                $.console.log('getChecked2:', tree.getChecked('value'));
                $.console.log('getChecked3:', tree.getChecked('value', 'device'));
                $.console.log('getValue0:', tree.getValue());
                $.console.log('getValue1:', tree.getValue('value'));
                $.console.log('getValue2:', tree.getValue('data'));
                $.console.log('getValue3:', tree.getValue('node'));
                
            },
            ondblclick: function (node, tree, ev) {
                $.console.log('ondblclick', tree.id, ev, node);
            },
            oncontextmenu: function (node, tree, ev) {
                $.console.log('oncontextmenu', tree.id, ev, node);
                if (node) {
                    $.cmenu({
                        id: 'nodemenu',
                        obj: 'tree',
                        width: 150,
                        items: [
                            { name: '新增子目录', func: function () { } },
                            { name: '展开', func: function () { node.expand(); } },
                            { name: '收缩', func: function () { node.collapse(); } },
                            //true: linkage, true: self
                            { name: '展开子节点', func: function () { node.expandChild(true, true); } },
                            //true: linkage, true: self
                            { name: '收缩子节点', func: function () { node.collapseChild(true, true); } },
                            { name: '展开设备', func: function () { node.expandChild(true, true, 'device'); } },
                            { name: '收缩设备', func: function () { node.collapseChild(true, true, 'device'); } },
                        ]
                    }, true).show(ev);
                } else {
                    $.cmenu({
                        id: 'treemenu',
                        obj: 'tree',
                        width: 'auto',
                        items: [
                            { name: '展开至一级', func: function () { tree.expandToLevel(0); } },
                            { name: '展开至二级', func: function () { tree.expandToLevel(1); } },
                            { name: '展开所有目录', func: function () { tree.expandToType('unit'); } },
                            { name: '收缩所有目录(包含子节点)', func: function () { tree.collapseToType('unit'); } },
                            //collapseToType：表示收缩指定类型的所有节点（包含不同类型的下级的子节点）
                            //collapseType: 表示收缩指定类型的节点（不收缩不同类型的子节点）
                            { name: '收缩所有目录', func: function () { tree.collapseType('unit'); } },
                            { name: '收缩至一级', func: function () { tree.collapseToLevel(1); } },
                            { name: '收缩至二级', func: function () { tree.collapseToLevel(2); } },
                            { sep: 1 },
                            { name: '全部展开', func: function () { tree.expandAll(); } },
                            { name: '全部收缩', func: function () { tree.collapseAll(); } },
                            { sep: 1 },
                            { name: '重新加载', func: function () { tree.reload(); } },
                        ]
                    }).show(ev);
                }
            },
            onchecked: function (node, tree) {
                $.console.log('onchecked:', tree.id, node);
            },
            //onexpand: function (node, tree, resolve) {
            onexpand: function (node, tree, resolve, reject) {
                $.console.log('onexpand:', tree.id, node, node.childs);
                if (!node.hasChild()) {
                    if (node.type === 'device') {
                        var cameras = [];
                        var pid = node.data.id;
                        for (var i = 0; i < 2; i++) {
                            cameras.push({id: pid + '_' + (i + 1), name:'监控点' + (i + 1), pid: pid });
                        }

                        //tree.add(cameras, {type:'camera', ptype:'device'});
                        if ($.isFunction(resolve)) {
                            //resolve(cameras, {type: 'camera'});
                            resolve(cameras, 'camera');
                        }
                    } else if (node.type === 'camera') {
                        var presets = [];
                        var pid = node.data.id;
                        for (var i = 0; i < 3; i++) {
                            presets.push({id: pid + '_' + (i + 1), name:'预置点' + (i + 1), pid: pid });
                        }
                        if ($.isFunction(resolve)) {
                            resolve(presets, 'preset');
                        }
                    }
                }
            },
            /*expandCallback: function (node, tree) {
                $.console.log('expandCallback:', tree.id, node);
            },
            */
            buttonCallback: function (node, tree, ev, key) {
                $.console.log('buttonCallback:', tree.id, node, key);
                var pid = node.data.id,
                    par = {type: 'preset', ptype: 'camera'},
                    items = [],
                    num = node.childs.length,
                    len = $('#txtPresetLen').val().toInt(1);

                switch(key) {
                case 'add':                    
                    if (node.type === 'camera') {
                        for (var i = 0; i < len; i++) {
                            items.push({id: pid + '_' + (num + i + 1), name: '预置点' + (num + i + 1), pid: pid});
                        }
                        $.tree(TreeId).add(items, par).expand(node);
                    }
                    break;
                case 'edit':
                    break;
                case 'del':
                    $.tree(TreeId).del(node);
                    break;
                case 'up':
                case 'down':
                    /*var num = key === 'up' ? -1 : 1;
                    $.tree(TreeId).sortIndex(node, num, function(node, num, idx) {
                        $.console.log('sortIndex:', node.id, key, num, idx);
                    });
                    */
                    break;
                }
            },
            onbutton: function (node, tree, ev, key) {

            },
            dragCallback: function (node, tree, dest, key, num, idx) {
                $.console.log('dragCallback:', tree.id, node, dest, key, num, idx);
            },
            sortCallback: function (node, tree, dest, num, idx) {
                $.console.log('sortCallback:', tree.id, node, dest, num, idx);
            }
        });
        $.console.log('test finish:');

        $.tree('tree1', {
            skin: skin, 
            data: testData1.list,
            callback: function(node, tree) {
                $.console.log('callback:', node, tree.cache, tree);
            }
        });
    }
  
</script>