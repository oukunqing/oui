
/*
	@Title: OUI
	@Description：JS通用代码库
	@Author: oukunqing
	@License：MIT

	$.gridmap 网格地图
*/

eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('!n($){\'3w 3x\';8 j={2n:$.3y(F),2o:\'1m.1b.\'};$.3z(j.2n,\'\',n(){},j.2o);8 k={1T:{},2p:n(a){o k.1T[\'2q\'+a]},2r:n(a,b){k.1T[\'2q\'+a]={D:a,13:b,};o 9}};8 l={2s:n(a,b){8 c={};q($.3A(a)){$.14(c,b,{7:a,D:a.D})}J q($.3B(a,F)){8 d=$.2t(a);$.14(c,b,{7:d,D:a})}J{$.14(c,a,b)}q(!c.7){o 2u}8 e=k.2p(c.D),13;q(e){13=e.13}J{13=3C 1U(c);k.2r(c.D,13)}o 13},1V:n(a){8 b=a.7.15;q(b){8 c=b.3D,1y=b.3E,2v=a.4.1n,2w=a.4.1c;q(c!==2v||1y!==2w){a.7.K=c;a.7.G=1y;a.4.1n=c;a.4.1c=1y;o F}}o L},3F:n(a){1z 1W=0;1z 1X=0;8 b=a.S;1o(8 i=0;i<b;i++){1W+=a[i].O;1X+=a[i].T}w 2x=1W/b;w 2y=1X/b;o{O:2x,T:2y}},2z:n(b){8 c=1p.2A(\'U\');c.D=\'1m-1b-2B-\'+b.D;c.1Y=\'1m-1b-r\';c.1A=[\'<2C V="E">1.12</2C>\',\'<a V="2D" 1B="重置">R</a>\',\'<a V="1C" 1B="回到中心点">C</a>\',\'<a V="1Z" 1B="放大一级">+</a>\',\'<a V="2E" 1B="缩小一级">-</a>\'].2F(\'\');b.7.15.2G(c);$.16(c,\'2H\',n(e){8 a=e.3G,3H=a.3I.3J(),2I=a.1Y.3K().3L(\' \')[0];3M(2I){1D\'1C\':b.1C();1q;1D\'2D\':l.2J(b);1q;1D\'1Z\':l.1E(b,1,F);1q;1D\'2E\':l.1E(b,-1,F);1q}});o 9},1F:n(a,b,c,d,e){8 f=a,7=f.7,4=f.4,21=f.W.22.S,23=f.W.1r.S,1d=4.H,M=1d,P=21>=23?21:23;q(!$.3N(b)||b<=0){o 9}q(c){M+=c*b;q(M<=0){M=1}J q(M>P){M=P}4.H=M}J{M=b>P?P:b;4.H=M}q(d){8 g=9.X(a,L),1G=9.X(a,L),2K=9.X(a,L,1d),2L=9.X(a,L,1d);8 h=4.z,t=4.t;q(e){Y.Z(\'(3O.x - 7.K / 2):\',(e.x-4.17));Y.Z(\'1F:\',e,4)}h-=(M-1d)*A*m/s.2M(g.E-2K.E);t-=(M-1d)*A*m/s.2M(1G.E-2L.E);4.z=h;4.t=t;Y.Z(\'1F:\',4.H,4.z,4.t,4.17)}o 9.24(a)},X:n(a,b,c){8 d=a.W,25=b?d.1r:d.22,P=25.S,1H=(c||a.4.H)-1;q(1H>=P){1H=P-1}8 e=25[1H]||[];o{1I:A,E:e[0],26:e[1],1J:b||L}},1K:n(a,b){8 c=a.W,D=\'3P\'+a.D+(b?\'3Q\':\'\'),Q=$I(D);q(!Q){Q=1p.2A(\'U\');Q.D=D;Q.1Y=\'1m-1b-3R\'+(b?\'-v\':\'\');Q.18.3S=\'\';Q.1A=[\'<U V="26"></U>\',\'<U V="3T"></U>\',\'<U V="3U"></U>\'].2F(\'\');a.7.15.2G(Q)}8 d=Q.3V,1L=b?\'G\':\'K\',E=9.X(a,b);d[0].18[1L]=E.1I+\'1s\';d[0].1A=E.26;d[1].18[1L]=E.1I+\'1s\';d[2].18[1L]=E.1I+\'1s\';q(!b&&c.1J&&c.1r&&c.1r.S>0){9.1K(a,F)}o 9},2N:n(a){a.4.z=0;a.4.t=0;o 9.N(a,L)},3W:n(a){o 9},2O:n(a){8 b=a.7,4=a.4,2P=b.15,27=$.3X(2P),1M=27.K/2,1N=27.G/2,x=1M*4.r+4.z,y=1N*4.r+4.t;o{x:x,y:y,1M:1M,1N:1N}},28:n(b,d,e,f){w R=3Y;w 2Q=b*s.1t/1u;w 2R=e*s.1t/1u;w 29=(e-b)*s.1t/1u;w 2a=(f-d)*s.1t/1u;w a=s.1O(29/2)*s.1O(29/2)+s.2S(2Q)*s.2S(2R)*s.1O(2a/2)*s.1O(2a/2);w c=2*s.3Z(s.2b(a),s.2b(1-a));w 1P=R*c;o 41(1P.42(3))},2T:n(a,b,c,d){q(!c.O||!c.T){o c}8 e=9,19=e.28(0,b.T,0,c.T),1a,x,y,1v=A,2U=c.T>=b.T?1:-1,1Q=1;q(d){1Q=c.G>=b.G?-1:1,1a=b.G-c.G}J{1Q=c.O>=b.O?-1:1,1a=e.28(b.O,0,c.O,0)}8 f=e.X(a,L),1G=e.X(a,d);$.Y.Z(\'19:\',19,1a,f,m/f.E,1v,m/f.E*1v);19*=m/f.E*1v/a.4.H;1a*=m/1G.E*1v/a.4.H;x=b.x+(2U*19);y=b.y+(1Q*1a);$.Y.Z(\'19:\',19,1a);o $.14(c,{x:x,y:y})},24:n(a){8 b=a.4;b.17+=b.z;b.1w+=b.t;o 9},2c:n(a){8 b=a.W,7=a.7,4=a.4,u=a.u;q(!b.2V){o 9}8 c=0.1;u.43(0,0,7.K,7.G);u.44=\'#2W\';u.45=c;q(b.2X){u.46([1,1])}8 d=b.2Y*(b.2e?1:4.r);8 e=b.2Z*(b.2e?1:4.r);8 f=s.31(-4.z/d)*d+4.z;8 g=s.31(-4.t/e)*e+4.t;1o(1z x=f;x<7.K;x+=d){u.2f();u.33(x+c,0);u.34(x+c,7.G);u.35()}1o(1z y=g;y<7.G;y+=e){u.2f();u.33(0,y+c);u.34(7.K,y+c);u.35()}o 9},36:n(a,b){q(!b.O&&b.x){o b}8 c=a.7,4=a.4,37=1u,38=47,1n=c.K,1c=c.G,39=1n/37,3a=1c/38;8 x=b.T*39,y=1c-(b.O*3a);o $.14(b,{x:x,y:y})},2g:n(a,b,c,d,e,f){8 g=c.x*e.r+e.z;8 h=c.y*e.r+e.t;q(g>=-d&&g<=a.K+d&&h>=-d&&h<=a.G+d){b.2f();b.48(g,h,d/2,0,s.1t*2);b.49()}o 9},2h:n(a){8 b=9,7=a.7,1e=a.W,u=a.u,B=a.4.B,2i=B.S,4a=b.2O(a);q(2i<=0){o 9}8 c=[\'#4b\',\'#4c\',\'#2W\',\'#4d\',\'#4e\'],3b=c.S;u.3c=c[0];8 d=6;8 p,2j;1o(8 i=0;i<2i;i++){u.3c=c[i%3b];p=B[i];p.3d=d/2;q(0===i){2j=p=p.O?l.36(a,p):p;b.2g(7,u,p,d,a.4,F)}J{p=b.2T(a,2j,p,1e.1J);b.2g(7,u,p,d,a.4,F)}}q($.3e()){$.Y.Z(\'B:\',B)}o 9},N:n(a,b){q(b){q(l.1V(a)){l.1K(a).2c(a).2h(a)}}J{l.1V(a);l.1K(a).2c(a).2h(a)}q($.3e()){$.Y.Z(\'4:\',a.4)}o 9},2k:n(a){1p.4f(\'#1m-1b-2B-\'+a.D+\' .E\').1A=a.4.r;o 9},1E:n(a,b,c){8 d=a.4,7=a.7;w 1f=d.r;q(c){d.r+=b}J{d.r*=b}d.r=s.P(1,s.3f(d.r,32));l.2k(a);d.H=d.r;w 17=7.K/2;w 1w=7.G/2;d.z=17-(17-d.z)*(d.r/1f);d.t=1w-(1w-d.t)*(d.r/1f);o l.N(a)},3g:n(a,b,x,y,c){8 d=a.4,1f=d.r;q(c){d.r+=b}J{d.r*=b}d.r=s.P(1,s.3f(d.r,32));l.2k(a);d.H=d.r;d.z=x-(x-d.z)*(d.r/1f);d.t=y-(y-d.t)*(d.r/1f);o l.N(a)},2J:n(a){8 b=a.4;b.r=1;b.z=0;b.t=0;o l.N(a)}};n 1U(a){8 b=$.14({2Y:A,2Z:A,22:[[11*m*m,\'11公里\'],[A*m*m,\'A公里\'],[20*m*m,\'20公里\'],[10*m*m,\'10公里\'],[5*m*m,\'5公里\'],[3*m*m,\'3公里\'],[2*m*m,\'2公里\'],[m*m,\'1公里\'],[1g*m,\'1g米\'],[1h*m,\'1h米\'],[1i*m,\'1i米\'],[1j*m,\'1j米\'],[11*m,\'11米\'],[A*m,\'A米\'],[40*m,\'40米\'],[30*m,\'30米\'],[20*m,\'20米\'],[10*m,\'10米\'],[3h,\'5米\'],[3i,\'2米\'],[m,\'1米\'],[1g,\'A厘米\'],[1h,\'40厘米\'],[1i,\'30厘米\'],[1j,\'20厘米\'],[11,\'10厘米\'],[A,\'5厘米\'],[20,\'2厘米\'],[10,\'1厘米\'],[5,\'5毫米\'],[2,\'2毫米\'],[1,\'1毫米\']],1r:[[m*m,\'1公里\'],[1g*m,\'1g米\'],[1h*m,\'1h米\'],[1i*m,\'1i米\'],[1j*m,\'1j米\'],[11*m,\'11米\'],[A*m,\'A米\'],[40*m,\'40米\'],[30*m,\'30米\'],[20*m,\'20米\'],[10*m,\'10米\'],[3h,\'5米\'],[3i,\'2米\'],[m,\'1米\'],[1g,\'A厘米\'],[1h,\'40厘米\'],[1i,\'30厘米\'],[1j,\'20厘米\'],[11,\'10厘米\'],[A,\'5厘米\'],[20,\'2厘米\'],[10,\'1厘米\'],[5,\'5毫米\'],[2,\'2毫米\'],[1,\'1毫米\']],1J:L,H:1,2e:F,2V:F,2X:F,B:[],2l:2u},a);9.W=b;9.7=$.2t(b.7);9.D=9.7.D;q(9.7){9.u=9.7.4g(\'2d\');9.7.15.18.4h=\'4i\'}9.4={1n:0,1c:0,r:b.r||1.0,H:b.H,z:0,t:0,1x:L,1R:0,1S:0,17:9.7.K/2,1w:9.7.G/2,B:[]};q($.3j(b.B)){9.4.B.4j(b.B)}9.3k()}1U.4k={3k:n(){8 b=9,1e=b.W,4=b.4,7=b.7;l.2z(b).N(b);l.1E(b,0,1e.H);$.16(4l,\'4m\',n(){$.4n({4o:A,4p:4q},n(){l.N(b)})});$.16(7,\'4r\',n(e){q(e.4s||e.4t){w 3l=(e.1k-4.z)/4.r;w 3m=(e.1l-4.t)/4.r;4.B.4u({x:3l,y:3m});l.N(b)}J{4.1x=F;4.1R=e.1k;4.1S=e.1l;7.18.3n=\'4v\'}});$.16([7,1p],\'4w\',n(e){q(4.1x){w 3o=e.1k-4.1R;w 3p=e.1l-4.1S;4.z+=3o;4.t+=3p;4.1R=e.1k;4.1S=e.1l;l.24(b).N(b)}});$.16([7,1p],\'4x\',n(e){q(4.1x){4.1x=L;7.18.3n=\'4y\'}});$.16([7],\'4z\',n(e){e.4A();8 a=7.15.4B,2m=7.15.4C;w 3q=e.1k-a;w 3r=e.1l-2m;w 3s=e.4D>0?-1:1;l.3g(b,3s,3q,3r,F)});$.16([7],\'2H\',n(e){8 a=7.4E(),3t=e.1k-a.4F,3u=e.1l-a.2m,B=b.4.B;1o(8 i=0;i<B.S;i++){8 p=B[i],1s=p.x*4.r+4.z,3v=p.y*4.r+4.t,1P=s.2b((3t-1s)**2+(3u-3v)**2);q(1P<=p.3d){$.Y.Z(\'4G:\',i,p);q($.4H(1e.2l)){1e.2l(e,p,b)}1q}}});o 9},1Z:n(a){o 9},4I:n(a){o 9},4J:n(){o 9},4K:n(a){8 b=9;b.4.B=$.3j(a)?a:[];o l.N(b),b},r:n(a,b){o l.1F(9,a,b,F).N(9),9},1C:n(){o l.2N(9)}};$.14({1b:n(a,b){o l.2s(a,b)}})}(4L);',62,296,'||||state|||canvas|var|this|||||||||||||1000|function|return||if|scale|Math|offsetY|ctx||const|||offsetX|50|points||id|ratio|true|height|scaleLevel||else|width|false|curLevel|drawGridMap|latitude|max|elem||length|longitude|div|class|options|getRatioRule|console|log||100||map|extend|parentNode|addListener|centerX|style|distanceHorizontal|distanceVertical|gridmap|canvasHeight|oldLevel|opt|oldScale|500|400|300|200|clientX|clientY|oui|canvasWidth|for|document|break|heightRules|px|PI|180|ruleSize|centerY|isDragging|curHeight|let|innerHTML|title|center|case|zoomAtCenter|setScaleLevel|ruleVertical|level|grid|vertical|setRatioRule|attr|xc|yc|sin|distance|symbolY|lastX|lastY|caches|GridMap|setCanvasSize|sumLat|sumLon|className|add||maxScale|scaleRules|maxHeightScale|setCenterPoint|rules|text|size|calculateDistance|a1|a2|sqrt|drawGrid||gridFixed|beginPath|drawPoint|drawPoints|len|p0|showScaleRatio|clickCallback|top|FilePath|FileName|getCache|gm_|setCache|buildGridMap|toElement|null|lastWidth|lastHeight|centerLat|centerLon|buildScaleBar|createElement|tools|span|reset|sub|join|appendChild|click|css|resetView|ruleHorizontalOld|ruleVerticalOld|abs|gotoCenter|getCanvasCenter|parent|d1|d2|cos|getPointPosition|symbolX|showLine|000|dashLine|gridWidth|gridHeight||floor||moveTo|lineTo|stroke|calcPointPosition|widthRange|heightRange|ratioWidth|ratioHeight|colorCount|fillStyle|radius|isDebug|min|zoomAtPoint|5000|2000|isArray|initial|worldX|worldY|cursor|dx|dy|mouseX|mouseY|delta|clickX|clickY|py|use|strict|getScriptSelfPath|loadJsScriptCss|isElement|isString|new|offsetWidth|offsetHeight|getPolygonCenter|target|tag|tagName|toLowerCase|trim|split|switch|isNumber|point|oui_gridmap_rule_|_v|rule|cssText|line2|line|childNodes|PolygonCenter|getOffset|6378137|atan2||parseFloat|toFixed|clearRect|strokeStyle|lineWidth|setLineDash|90|arc|fill|pc|f00|00f|008000|f50|querySelector|getContext|position|relative|concat|prototype|window|resize|debounce|delay|timeout|3000|mousedown|ctrlKey|metaKey|push|grabbing|mousemove|mouseup|default|wheel|preventDefault|offsetLeft|offsetTop|deltaY|getBoundingClientRect|left|ppp|isFunction|remove|clear|update|OUI'.split('|'),0,{}))
