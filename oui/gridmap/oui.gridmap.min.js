
/*
	@Title: OUI
	@Description：JS通用代码库
	@Author: oukunqing
	@License：MIT

	$.gridmap 网格地图
*/

eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('!n($){\'3r 3s\';8 j={2k:$.3t(F),2l:\'1l.1a.\'};$.3u(j.2k,\'\',n(){},j.2l);8 k={1R:{},2m:n(a){o k.1R[\'2n\'+a]},2o:n(a,b){k.1R[\'2n\'+a]={D:a,Z:b,};o m}};8 l={2p:n(a,b){8 c={};q($.3v(a)){$.11(c,b,{7:a,D:a.D})}J q($.3w(a,F)){8 d=$.2q(a);$.11(c,b,{7:d,D:a})}J{$.11(c,a,b)}q(!c.7){o 2r}8 e=k.2m(c.D),Z;q(e){Z=e.Z}J{Z=3x 1S(c);k.2o(c.D,Z)}o Z},1T:n(a){8 b=a.7.13;q(b){8 c=b.3y,1x=b.3z,2s=a.4.1m,2t=a.4.1b;q(c!==2s||1x!==2t){a.7.K=c;a.7.G=1x;a.4.1m=c;a.4.1b=1x;o F}}o L},2u:n(b){8 c=1n.2v(\'T\');c.D=\'1l-1a-2w-\'+b.D;c.1U=\'1l-1a-r\';c.1y=[\'<2x U="E">1.12</2x>\',\'<a U="2y" 1z="重置">R</a>\',\'<a U="1A" 1z="回到中心点">C</a>\',\'<a U="1V" 1z="放大一级">+</a>\',\'<a U="2z" 1z="缩小一级">-</a>\'].2A(\'\');b.7.13.2B(c);$.14(c,\'2C\',n(e){8 a=e.3A,3B=a.3C.3D(),2D=a.1U.3E().3F(\' \')[0];3G(2D){1B\'1A\':b.1A();1o;1B\'2y\':l.2E(b);1o;1B\'1V\':l.1W(b,1,F);1o;1B\'2z\':l.1W(b,-1,F);1o}});o m},1C:n(a,b,c,d,e){8 f=a,7=f.7,4=f.4,1X=f.V.1Y.15,1Z=f.V.1p.15,1c=4.H,M=1c,O=1X>=1Z?1X:1Z;q(!$.3H(b)||b<=0){o m}q(c){M+=c*b;q(M<=0){M=1}J q(M>O){M=O}4.H=M}J{M=b>O?O:b;4.H=M}q(d){8 g=m.W(a,L),1D=m.W(a,L),2F=m.W(a,L,1c),2G=m.W(a,L,1c);8 h=4.w,t=4.t;q(e){P.Q(\'(3I.x - 7.K / 2):\',(e.x-4.16));P.Q(\'1C:\',e,4)}h-=(M-1c)*A*9/s.2H(g.E-2F.E);t-=(M-1c)*A*9/s.2H(1D.E-2G.E);4.w=h;4.t=t;P.Q(\'1C:\',4.H,4.w,4.t,4.16)}o m.21(a)},W:n(a,b,c){8 d=a.V,22=b?d.1p:d.1Y,O=22.15,1E=(c||a.4.H)-1;q(1E>=O){1E=O-1}8 e=22[1E]||[];o{1F:A,E:e[0],23:e[1],1G:b||L}},1H:n(a,b){8 c=a.V,D=\'3J\'+a.D+(b?\'3K\':\'\'),S=$I(D);q(!S){S=1n.2v(\'T\');S.D=D;S.1U=\'1l-1a-3L\'+(b?\'-v\':\'\');S.17.3M=\'\';S.1y=[\'<T U="23"></T>\',\'<T U="3N"></T>\',\'<T U="3O"></T>\'].2A(\'\');a.7.13.2B(S)}8 d=S.3P,1I=b?\'G\':\'K\',E=m.W(a,b);d[0].17[1I]=E.1F+\'1q\';d[0].1y=E.23;d[1].17[1I]=E.1F+\'1q\';d[2].17[1I]=E.1F+\'1q\';q(!b&&c.1G&&c.1p&&c.1p.15>0){m.1H(a,F)}o m},2I:n(a){a.4.w=0;a.4.t=0;o m.N(a,L)},2J:n(a){8 b=a.7,4=a.4,2K=b.13,24=$.3Q(2K),1J=24.K/2,1K=24.G/2,x=1J*4.r+4.w,y=1K*4.r+4.t;o{x:x,y:y,1J:1J,1K:1K}},25:n(b,d,e,f){z R=3R;z 2L=b*s.1r/1s;z 2M=e*s.1r/1s;z 26=(e-b)*s.1r/1s;z 27=(f-d)*s.1r/1s;z a=s.1L(26/2)*s.1L(26/2)+s.2N(2L)*s.2N(2M)*s.1L(27/2)*s.1L(27/2);z c=2*s.3S(s.28(a),s.28(1-a));z 1M=R*c;o 3T(1M.3U(3))},2O:n(a,b,c,d){q(!c.X||!c.1d){o c}8 e=m,18=e.25(0,b.1d,0,c.1d),19,x,y,1t=A,2P=c.1d>=b.1d?1:-1,1N=1;q(d){1N=c.G>=b.G?-1:1,19=b.G-c.G}J{1N=c.X>=b.X?-1:1,19=e.25(b.X,0,c.X,0)}8 f=e.W(a,L),1D=e.W(a,d);$.P.Q(\'18:\',18,19,f,9/f.E,1t,9/f.E*1t);18*=9/f.E*1t/a.4.H;19*=9/1D.E*1t/a.4.H;x=b.x+(2P*18);y=b.y+(1N*19);$.P.Q(\'18:\',18,19);o $.11(c,{x:x,y:y})},21:n(a){8 b=a.4;b.16+=b.w;b.1u+=b.t;o m},29:n(a){8 b=a.V,7=a.7,4=a.4,u=a.u;q(!b.2Q){o m}8 c=0.1;u.3V(0,0,7.K,7.G);u.3W=\'#2R\';u.3X=c;q(b.2S){u.3Y([1,1])}8 d=b.2T*(b.2a?1:4.r);8 e=b.2U*(b.2a?1:4.r);8 f=s.2V(-4.w/d)*d+4.w;8 g=s.2V(-4.t/e)*e+4.t;1O(2W x=f;x<7.K;x+=d){u.2b();u.2X(x+c,0);u.2Y(x+c,7.G);u.2Z()}1O(2W y=g;y<7.G;y+=e){u.2b();u.2X(0,y+c);u.2Y(7.K,y+c);u.2Z()}o m},31:n(a,b){q(!b.X&&b.x){o b}8 c=a.7,4=a.4,33=1s,34=3Z,1m=c.K,1b=c.G,35=1m/33,36=1b/34;8 x=b.1d*35,y=1b-(b.X*36);o $.11(b,{x:x,y:y})},2c:n(a,b,c,d,e,f){8 g=c.x*e.r+e.w;8 h=c.y*e.r+e.t;q(g>=-d&&g<=a.K+d&&h>=-d&&h<=a.G+d){b.2b();b.41(g,h,d/2,0,s.1r*2);b.42()}o m},2e:n(a){8 b=m,7=a.7,1v=a.V,u=a.u,B=a.4.B,2f=B.15,43=b.2J(a);q(2f<=0){o m}8 c=[\'#44\',\'#45\',\'#2R\',\'#46\',\'#47\'],37=c.15;u.38=c[0];8 d=6;8 p,2g;1O(8 i=0;i<2f;i++){u.38=c[i%37];p=B[i];p.39=d/2;q(0===i){2g=p=p.X?l.31(a,p):p;P.Q(\'i:\',i,\',p:\',p);b.2c(7,u,p,d,a.4,F)}J{p=b.2O(a,2g,p,1v.1G);P.Q(\'i:\',i,\',p:\',p);b.2c(7,u,p,d,a.4,F)}}$.P.Q(\'B:\',B);o m},N:n(a,b){q(b){q(l.1T(a)){l.1H(a).29(a).2e(a)}}J{l.1T(a);l.1H(a).29(a).2e(a)}o m},2h:n(a){1n.48(\'#1l-1a-2w-\'+a.D+\' .E\').1y=a.4.r;o m},1W:n(a,b,c){8 d=a.4,7=a.7;z 1e=d.r;q(c){d.r+=b}J{d.r*=b}d.r=s.O(1,s.3a(d.r,32));l.2h(a);d.H=d.r;z 16=7.K/2;z 1u=7.G/2;d.w=16-(16-d.w)*(d.r/1e);d.t=1u-(1u-d.t)*(d.r/1e);o l.N(a)},3b:n(a,b,x,y,c){8 d=a.4,1e=d.r;q(c){d.r+=b}J{d.r*=b}d.r=s.O(1,s.3a(d.r,32));l.2h(a);d.H=d.r;d.w=x-(x-d.w)*(d.r/1e);d.t=y-(y-d.t)*(d.r/1e);o l.N(a)},2E:n(a){8 b=a.4;b.r=1;b.w=0;b.t=0;o l.N(a)}};n 1S(a){8 b=$.11({2T:A,2U:A,1Y:[[Y*9*9,\'Y公里\'],[A*9*9,\'A公里\'],[20*9*9,\'20公里\'],[10*9*9,\'10公里\'],[5*9*9,\'5公里\'],[3*9*9,\'3公里\'],[2*9*9,\'2公里\'],[9*9,\'1公里\'],[1f*9,\'1f米\'],[1g*9,\'1g米\'],[1h*9,\'1h米\'],[1i*9,\'1i米\'],[Y*9,\'Y米\'],[A*9,\'A米\'],[40*9,\'40米\'],[30*9,\'30米\'],[20*9,\'20米\'],[10*9,\'10米\'],[3c,\'5米\'],[3d,\'2米\'],[9,\'1米\'],[1f,\'A厘米\'],[1g,\'40厘米\'],[1h,\'30厘米\'],[1i,\'20厘米\'],[Y,\'10厘米\'],[A,\'5厘米\'],[20,\'2厘米\'],[10,\'1厘米\'],[5,\'5毫米\'],[2,\'2毫米\'],[1,\'1毫米\']],1p:[[9*9,\'1公里\'],[1f*9,\'1f米\'],[1g*9,\'1g米\'],[1h*9,\'1h米\'],[1i*9,\'1i米\'],[Y*9,\'Y米\'],[A*9,\'A米\'],[40*9,\'40米\'],[30*9,\'30米\'],[20*9,\'20米\'],[10*9,\'10米\'],[3c,\'5米\'],[3d,\'2米\'],[9,\'1米\'],[1f,\'A厘米\'],[1g,\'40厘米\'],[1h,\'30厘米\'],[1i,\'20厘米\'],[Y,\'10厘米\'],[A,\'5厘米\'],[20,\'2厘米\'],[10,\'1厘米\'],[5,\'5毫米\'],[2,\'2毫米\'],[1,\'1毫米\']],1G:L,H:1,2a:F,2Q:F,2S:F,B:[],2i:2r},a);m.V=b;m.7=$.2q(b.7);m.D=m.7.D;q(m.7){m.u=m.7.49(\'2d\');m.7.13.17.4a=\'4b\'}m.4={1m:0,1b:0,r:b.r||1.0,H:b.H,w:0,t:0,1w:L,1P:0,1Q:0,16:m.7.K/2,1u:m.7.G/2,B:[]};q($.3e(b.B)){m.4.B.4c(b.B)}m.3f()}1S.4d={3f:n(){8 b=m,1v=b.V,4=b.4,7=b.7;l.2u(b).N(b);$.14(4e,\'4f\',n(){$.4g({4h:A,4i:4j},n(){l.N(b)})});$.14(7,\'4k\',n(e){q(e.4l||e.4m){z 3g=(e.1j-4.w)/4.r;z 3h=(e.1k-4.t)/4.r;4.B.4n({x:3g,y:3h});l.N(b)}J{4.1w=F;4.1P=e.1j;4.1Q=e.1k;7.17.3i=\'4o\'}});$.14([7,1n],\'4p\',n(e){q(4.1w){z 3j=e.1j-4.1P;z 3k=e.1k-4.1Q;4.w+=3j;4.t+=3k;4.1P=e.1j;4.1Q=e.1k;l.21(b).N(b)}});$.14([7,1n],\'4q\',n(e){q(4.1w){4.1w=L;7.17.3i=\'4r\'}});$.14([7],\'4s\',n(e){e.4t();8 a=7.13.4u,2j=7.13.4v;z 3l=e.1j-a;z 3m=e.1k-2j;z 3n=e.4w>0?-1:1;l.3b(b,3n,3l,3m,F)});$.14([7],\'2C\',n(e){8 a=7.4x(),3o=e.1j-a.4y,3p=e.1k-a.2j,B=b.4.B;1O(8 i=0;i<B.15;i++){8 p=B[i],1q=p.x*4.r+4.w,3q=p.y*4.r+4.t,1M=s.28((3o-1q)**2+(3p-3q)**2);q(1M<=p.39){$.P.Q(\'4z:\',i,p);q($.4A(1v.2i)){1v.2i(e,p,b)}1o}}});o m},1V:n(a){o m},4B:n(a){o m},4C:n(){o m},4D:n(a){8 b=m;b.4.B=$.3e(a)?a:[];o l.N(b),b},r:n(a,b){o l.1C(m,a,b,F).N(m),m},1A:n(){o l.2I(m)}};$.11({1a:n(a,b){o l.2p(a,b)}})}(4E);',62,289,'||||state|||canvas|var|1000|||||||||||||this|function|return||if|scale|Math|offsetY|ctx||offsetX|||const|50|points||id|ratio|true|height|scaleLevel||else|width|false|curLevel|drawGridMap|max|console|log||elem|div|class|options|getRatioRule|latitude|100|map||extend||parentNode|addListener|length|centerX|style|distanceHorizontal|distanceVertical|gridmap|canvasHeight|oldLevel|longitude|oldScale|500|400|300|200|clientX|clientY|oui|canvasWidth|document|break|heightRules|px|PI|180|ruleSize|centerY|opt|isDragging|curHeight|innerHTML|title|center|case|setScaleLevel|ruleVertical|level|grid|vertical|setRatioRule|attr|xc|yc|sin|distance|symbolY|for|lastX|lastY|caches|GridMap|setCanvasSize|className|add|zoomAtCenter|maxScale|scaleRules|maxHeightScale||setCenterPoint|rules|text|size|calculateDistance|a1|a2|sqrt|drawGrid|gridFixed|beginPath|drawPoint||drawPoints|len|p0|showScaleRatio|clickCallback|top|FilePath|FileName|getCache|gm_|setCache|buildGridMap|toElement|null|lastWidth|lastHeight|buildScaleBar|createElement|tools|span|reset|sub|join|appendChild|click|css|resetView|ruleHorizontalOld|ruleVerticalOld|abs|gotoCenter|getCanvasCenter|parent|d1|d2|cos|getPointPosition|symbolX|showLine|000|dashLine|gridWidth|gridHeight|floor|let|moveTo|lineTo|stroke||calcPointPosition||widthRange|heightRange|ratioWidth|ratioHeight|colorCount|fillStyle|radius|min|zoomAtPoint|5000|2000|isArray|initial|worldX|worldY|cursor|dx|dy|mouseX|mouseY|delta|clickX|clickY|py|use|strict|getScriptSelfPath|loadJsScriptCss|isElement|isString|new|offsetWidth|offsetHeight|target|tag|tagName|toLowerCase|trim|split|switch|isNumber|point|oui_gridmap_rule_|_v|rule|cssText|line2|line|childNodes|getOffset|6378137|atan2|parseFloat|toFixed|clearRect|strokeStyle|lineWidth|setLineDash|90||arc|fill|pc|f00|00f|008000|f50|querySelector|getContext|position|relative|concat|prototype|window|resize|debounce|delay|timeout|3000|mousedown|ctrlKey|metaKey|push|grabbing|mousemove|mouseup|default|wheel|preventDefault|offsetLeft|offsetTop|deltaY|getBoundingClientRect|left|ppp|isFunction|remove|clear|update|OUI'.split('|'),0,{}))
